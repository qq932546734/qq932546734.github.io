<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang>
<head><meta name="generator" content="Hexo 3.9.0">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta property="og:type" content="website">
<meta property="og:title" content="LegendGH">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="LegendGH">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="LegendGH">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/">





  <title>LegendGH</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">LegendGH</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">To Be Number One!</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="Searching..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/24/linalg/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="LegendGH">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LegendGH">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/24/linalg/" itemprop="url">线性代数</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-09-24T08:56:47+08:00">
                2019-09-24
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="矩阵与方程组"><a href="#矩阵与方程组" class="headerlink" title="矩阵与方程组"></a>矩阵与方程组</h2><hr>
<h3 id="严格三角形的方程组"><a href="#严格三角形的方程组" class="headerlink" title="严格三角形的方程组"></a>严格三角形的方程组</h3><p>若方程组中，第k个方程的前k-1个变量的系数均为零，且$x_k(k=1,…, n)$的系数不为零，则称该方程组为严格三角形的。</p>
<h3 id="增广矩阵"><a href="#增广矩阵" class="headerlink" title="增广矩阵"></a>增广矩阵</h3><p>在方程组的系数矩阵的右侧添加一列方程组的右端项，得到增广矩阵</p>
<h3 id="初等行运算"><a href="#初等行运算" class="headerlink" title="初等行运算"></a>初等行运算</h3><ol>
<li>交换两行</li>
<li>以非零实数乘于某行</li>
<li>将某行替换成它与其他某行的倍数的和</li>
</ol>
<h3 id="行阶梯形矩阵"><a href="#行阶梯形矩阵" class="headerlink" title="行阶梯形矩阵"></a>行阶梯形矩阵</h3><p>若一个矩阵满足：</p>
<ol>
<li>每一个非零行中的第一个非零元为1；</li>
<li>第$k$行的元不全为零，第$k+1$行首变量之前零的个数多于第k行首变量之前零的个数；</li>
<li>所有元素均为零的行必在不全为零的行之后。</li>
</ol>
<h3 id="超定方程组"><a href="#超定方程组" class="headerlink" title="超定方程组"></a>超定方程组</h3><p>若一个线性方程组中方程的个数多于未知量的个数，称之为超定方程组。通常为不相容的。</p>
<h3 id="亚定方程组"><a href="#亚定方程组" class="headerlink" title="亚定方程组"></a>亚定方程组</h3><p>若一个线性方程组中方程的个数少于未知量的个数，称之为亚定方程组。通常为相容的（存在不相容的情况），且如果相容的话，必有无穷组解。</p>
<h3 id="行最简形矩阵"><a href="#行最简形矩阵" class="headerlink" title="行最简形矩阵"></a>行最简形矩阵</h3><p>矩阵是行阶梯形的，且每一行的第一个非零元是该列唯一的非零行。</p>
<h3 id="求解线性方程组的方法"><a href="#求解线性方程组的方法" class="headerlink" title="求解线性方程组的方法"></a>求解线性方程组的方法</h3><ul>
<li>回代法</li>
<li>高斯消元法：利用初等行运算将线性方程组的增广矩阵化为<strong>行阶梯形矩阵</strong></li>
<li>高斯-若尔当消元法：采用初等行运算将线性方程组的增广矩阵化成<strong>行最简形</strong></li>
</ul>
<h3 id="齐次方程组"><a href="#齐次方程组" class="headerlink" title="齐次方程组"></a>齐次方程组</h3><p><s>右端项全为零的线性方程组。齐次方程组必有平凡解，即所有变量都为零。若齐次方程组为亚定方程组，即方程个数小于变量的个数，该方程组必有非平凡解。</s></p>
<h3 id="线性方程组相容"><a href="#线性方程组相容" class="headerlink" title="线性方程组相容"></a>线性方程组相容</h3><p>一个线性方程组 $A\textbf{x}=\textbf{b}$ 相容的充要条件是向量$b$可写成矩阵A列向量的一个线性组合。</p>
<h3 id="对称矩阵"><a href="#对称矩阵" class="headerlink" title="对称矩阵"></a>对称矩阵</h3><p>若满足$A=A^T$,为对称矩阵</p>
<h3 id="矩阵的逆、非奇异矩阵"><a href="#矩阵的逆、非奇异矩阵" class="headerlink" title="矩阵的逆、非奇异矩阵"></a>矩阵的逆、非奇异矩阵</h3><p>若存在一个矩阵$B$使得$AB=BA=I$, 则称$n\times n$矩阵A为可逆的，也为非奇异的。若矩阵不存在乘法逆元，则称之为奇异的。</p>
<blockquote>
<p>只有方阵才有逆，才有奇异性这么一说</p>
</blockquote>
<h3 id="矩阵运算"><a href="#矩阵运算" class="headerlink" title="矩阵运算"></a>矩阵运算</h3><ol>
<li>$(AB)^T = {B^T}{A^T}$</li>
<li>$(AB)^{-1} = B^{-1}A^{-1}$(前提条件是AB都是方阵，且都可逆)</li>
</ol>
<blockquote>
<p>1可以通过矩阵的元素$a_{ij}$进行证明；2中，$(AB)^{-1}$满足$(AB)(AB)^{-1} = I$，而在AB都是方阵的情况下，$(AB)B^{-1}A^{-1} = I$，所以$AB$的逆等于$B^{-1}A^{-1}$</p>
</blockquote>
<h3 id="初等矩阵"><a href="#初等矩阵" class="headerlink" title="初等矩阵"></a>初等矩阵</h3><p>从单位矩阵经过一次初等行运算，得到的矩阵为初等矩阵。初等矩阵分为三类：</p>
<ol>
<li>交换单位矩阵的两行，逆运算为本身</li>
<li>单位矩阵的某一行乘以一个非零常数a，逆运算等于乘以1/a</li>
<li>单位矩阵的某一行的倍数加到另外一行，逆运算等于减去该倍数  </li>
</ol>
<p>矩阵$A$左乘初等矩阵$E_1$(即$E_1*A$)等于将矩阵$A$按照初等矩阵$E_1$的行变换进行行变换。右乘初等矩阵等于按照初等矩阵的列变换进行相应的列变换。<br>$$<br>\begin{align}<br>E_3 = \begin{bmatrix} 1 &amp; 0 &amp; 3\\ 0 &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; 1\end{bmatrix} \\<br>E_3A = \begin{bmatrix} a_{11}+3a_{31} &amp; a_{12}+3a_{32} &amp; a_{13}+3a_{33} \\<br>a_{21} &amp; a_{22} &amp; a_{23} \\<br>a_{31} &amp; a_{32} &amp; a_{33} \end{bmatrix} \\<br>AE_3 = \begin{bmatrix} a_{11} &amp; a_{12} &amp; 3a_{11} + a_{13} \\<br>a_{21} &amp; a_{22} &amp; 3a_{21} + a_{23} \\<br>a_{31} &amp; a_{32} &amp; 3a_{31}+a_{33} \end{bmatrix}<br>\end{align}<br>$$</p>
<h3 id="行等价"><a href="#行等价" class="headerlink" title="行等价"></a>行等价</h3><p>若存在一个有限初等矩阵序列$E_1, E_2, E_3, …, E_k$， 使得 $B = E_kE_{k-1}…E_1A$，则称A和B是行等价的。</p>
<h3 id="非奇异矩阵的等价条件"><a href="#非奇异矩阵的等价条件" class="headerlink" title="非奇异矩阵的等价条件"></a>非奇异矩阵的等价条件</h3><ol>
<li>$A$是非奇异的</li>
<li>$Ax=0$仅有平凡解$0$，即$N(A)=0$</li>
<li>$A$与$I$行等价</li>
</ol>
<h3 id="矩阵求逆"><a href="#矩阵求逆" class="headerlink" title="矩阵求逆"></a>矩阵求逆</h3><p>将矩阵A与单位矩阵构成增广矩阵，然后用高斯消元法将A化成单位矩阵，右侧的结果便是$A^{-1}$</p>
<h3 id="LU分解、三角形分解"><a href="#LU分解、三角形分解" class="headerlink" title="LU分解、三角形分解"></a>LU分解、三角形分解</h3><p>如果一个$n\times n$矩阵A可以仅利用初等矩阵运算三（某一行的倍数加到另一行）化简为严格的上三角形的，则A有一个$LU$分解。$U$为严格的上三角形矩阵。<br>$L$为单位下三角矩阵（对角元素为1），且当$i&gt;j$，$L_{ij}$为消元过程中第$i$行减去第$j$行的倍数。</p>
<h3 id="外积？？？"><a href="#外积？？？" class="headerlink" title="外积？？？"></a>外积？？？</h3><p>不同于内积$x^Ty$，外积等于$xy^T$<br>$$<br>xy^T = \begin{bmatrix} x_1 \\ x_2 \\ \vdots \\ x_n \\ \end{bmatrix}<br>(y_1, y_2, …, y_n)<br>$$</p>
<h3 id="向量积"><a href="#向量积" class="headerlink" title="向量积"></a>向量积</h3><p>给定$R^3$中的两个向量$x$和$y$，可以定义第三个向量，即向量积，记为$x\times y$:<br>$$<br>x \times y =  \left\lvert<br>\begin{matrix} e_1 &amp; e_2 &amp; e_3 \\<br>x_1 &amp; x_2 &amp; x_3 \\<br>y_1 &amp; y_2 &amp; y_3 \\  \end{matrix}<br>\right\rvert<br>$$<br>将以上行列式第一行换成第二行或者第三行的元素，根据行列式的性质，存在两行相等的行列式为0，故<br>$$<br>x^T(x\times y) = y^T(x\times y) = 0<br>$$<br>内积为0的两向量正交，故$(x\times y)$跟$x$和$y$都正交。<br>向量积的欧几里得长度等于<br>$$<br>\left\lVert x\times y \right\rVert = \left\lVert x \right\rVert \left\lVert y \right\rVert \sin\theta<br>$$</p>
<h2 id="行列式"><a href="#行列式" class="headerlink" title="行列式"></a>行列式</h2><hr>
<h3 id="矩阵的行列式"><a href="#矩阵的行列式" class="headerlink" title="矩阵的行列式"></a>矩阵的行列式</h3><h4 id="定义和意义"><a href="#定义和意义" class="headerlink" title="定义和意义"></a>定义和意义</h4><p>方阵的行列式主要用来表示矩阵是否为奇异的，也即矩阵是否可逆。为判断一个矩阵是否可逆，我们利用初等行运算将矩阵转化成上三角矩阵， </p>
<p>对于$n=1$的方阵，$det(A) = a$</p>
<h3 id="子式和余子式"><a href="#子式和余子式" class="headerlink" title="子式和余子式"></a>子式和余子式</h3><p>令$A=(a_{ij})$为一$n*n$矩阵，并用$M_{ij}$来表示删除A中包含$a_{ij}$的行和列得到的$(n-1)(n-1)$矩阵。矩阵$M_{ij}$的行列式为$a_{ij}$的子式。<br>$a_{ij}$的余子式$A_{ij}$为<br>$$ A_{ij} = (-1)^{i+j}det(M_{ij})$$</p>
<h3 id="行列式-1"><a href="#行列式-1" class="headerlink" title="行列式"></a>行列式</h3><p>$$<br>det(A) = \begin{cases}<br>a_{11} &amp; \text{当n=1时} \\<br>a_{i1}A_{i1}+a_{i2}A_{i2} + \cdots + a_{in}A_{in} &amp; \text{当n &gt; 1时，取第i行} \\<br>a_{1j}A_{1j} + a_{2j}A_{2j} + \cdots + a_{nj}A_{nj} &amp; \text{当n &gt; 1时，取第j列} \\<br>\end{cases}<br>$$<br>矩阵行列式等于矩阵转置的行列式<br>$$<br>det(A) = det(A^T)<br>$$<br>行列式性质</p>
<ol>
<li>三角矩阵的行列式等于对角元素的乘积</li>
<li>若矩阵有一行或一列全为0，则$det(A)=0$</li>
<li>若矩阵有两行或两列相等，则$det(A)=0$</li>
</ol>
<h2 id="向量空间"><a href="#向量空间" class="headerlink" title="向量空间"></a>向量空间</h2><hr>
<h3 id="常见的向量空间"><a href="#常见的向量空间" class="headerlink" title="常见的向量空间"></a>常见的向量空间</h3><ol>
<li>欧几里得向量空间（$R^n$），相同长度和相同方向的向量是相同的；</li>
<li>向量空间$R^{m*n}$，矩阵空间</li>
<li>定义在某个区间内的实值连续函数空间，$C[a,b]$，全集为一函数集合</li>
<li>定义在某个区间内的n阶实值连续可导函数空间，$C^n[a,b]$</li>
<li>多项式向量空间$P_n$，表示次数小于n的所有多项式集合</li>
</ol>
<h3 id="矩阵的零空间"><a href="#矩阵的零空间" class="headerlink" title="矩阵的零空间"></a>矩阵的零空间</h3><p>令$A$为一$m*n$矩阵，矩阵的零空间表示为$N(A)$<br>$$ N(A) = \lbrace x \in R^n | Ax=0 \rbrace $$</p>
<h3 id="线性组合和张成"><a href="#线性组合和张成" class="headerlink" title="线性组合和张成"></a>线性组合和张成</h3><p>令$v_1, v_2, v_3, \cdots, v_n$为向量空间$V$中的向量，则$a_1v_1 + a_2v_2+\cdots+a_nv_n$称为向量$v_1, v_2, v_3, \cdots, v_n$的线性组合。它们构成的集合称为$v_1, v_2, v_3, \cdots, v_n$的张成，记为$Span(v_1,\cdots,v_n)$.<br>$Span(v_1,\cdots, v_n)$是V的一个子空间。若$Span(v_1,\cdots, v_n) = V$，我们说向量$v_1,\cdots, v_n$张成向量V，${v_1,\cdots, v_n}$是V的一个张集。</p>
<h3 id="相容线性方程组的解集"><a href="#相容线性方程组的解集" class="headerlink" title="相容线性方程组的解集"></a>相容线性方程组的解集</h3><p>若线性方程组$Ax=b$是相容的，$x_0$为它的一个特解，则向量$y$也为其解的充要条件为$y=x_0+z$，其中$z \in N(A)$.<br>由此我们可以推出求解所有解集的方法：先求出齐次方程的解，然后求一个特解$x_0$，解集即为：$x_0 + a_1z_1 + a_2z_2 + \cdots + a_nz_n$，其中，$z\in N(A)$</p>
<blockquote>
<p>令$x_0$为方程组$Ax=b$的一个特解，若$x_1$为方程组的另一个解，则$Ax_1 - Ax_0 = 0$， $A(x_1-x_0)=0$，进而可推出，$x_1-x_0$在A的零空间内，$x_1=x_0+z, z \in N(A)$。</p>
</blockquote>
<h3 id="向量线性相关的充要条件"><a href="#向量线性相关的充要条件" class="headerlink" title="向量线性相关的充要条件"></a>向量线性相关的充要条件</h3><p>令$x_1, x_2, \cdots, x_n$ 为$R^n$中的n个向量，并令$X=(x_1, x_2, \cdots, x_n)$.向量$x_1, x_2, \cdots, x_n$线性相关的充要条件是$X$为奇异的。<br>方程$c_1x_1+c_2x_2 + \cdots + c_nx_n = 0$ 可以写成$Xc=0$，若X非奇异，则X存在逆$X^{-1}$，$Xc=0$无非平凡解，即不存在不全为0的$c_1, c_2, \cdots, c_n$，使得该方程成立，表明$x_1, x_2, \cdots, x_n$线性无关。<br>方程$c_1x_1+c_2x_2 + \cdots + c_kx_k = 0$ 中，若k不等于n，即构造的$X$不是方阵，此时不能用X是否奇异来判断线性相关性；此时判别的标准是–$X$的行阶梯型含有自由变量则线性相关。行阶梯型有自由变量表明方程组有非平凡解。</p>
<h3 id="基"><a href="#基" class="headerlink" title="基"></a>基</h3><p>当且仅当向量空间$V$中的向量$v_1, v_2, \cdots, v_n$ 满足$v_1, v_2, \cdots, v_n$ 线性无关；$v_1, v_2, \cdots, v_n$ 张成$V$：时（即$Span(v_1, v_2, \cdots, v_n) = V$)，称它们是向量空间$V$的基。</p>
<p>若向量空间$V$的一个张集为${v_1, v_2, \cdots, v_n}$，则若$m&gt;n$，$V$中任何m个向量必线性相关。</p>
<p>若${v_1, v_2, \cdots, v_n}$和${u_1, u_2, \cdots, u_n}$均为向量空间$V$的基，则$n=m$</p>
<h3 id="维数、维度"><a href="#维数、维度" class="headerlink" title="维数、维度"></a>维数、维度</h3><p>令$V$为一向量空间，若其一组基含有n个向量，我们称$V$的维数为n。</p>
<h3 id="标准基"><a href="#标准基" class="headerlink" title="标准基"></a>标准基</h3><p>$R^n$的标准基是${e_1, e_2, \cdots, e_n}$，$P_n$的标准基是${1, x, x^2, \cdots, x^n}$。标准基之所以为标准基，是因为其最为自然地张成对应的向量空间。</p>
<h3 id="普通基和标准基之间的转换"><a href="#普通基和标准基之间的转换" class="headerlink" title="普通基和标准基之间的转换"></a>普通基和标准基之间的转换</h3><p>令$E=[v_1, v_2, \cdots, v_n]$为向量空间$V$的一组有序基，转换矩阵$S=(v_1, v_2, \cdots, v_n)$, 从E转换到标准基的转换矩阵为S，从标准基转换到E的转换矩阵为$S^{-1}$</p>
<h3 id="普通基之间的转换"><a href="#普通基之间的转换" class="headerlink" title="普通基之间的转换"></a>普通基之间的转换</h3><p>令$E=[v_1, v_2, \cdots, v_n]$和$F=[w_1, w_2, \cdots, w_n]$为向量空间$V$的两组有序基，同时令$U=(v_1, v_2, \cdots, v_n)$, $V=(w_1, w_2, \cdots, w_n)$，则从E到F的转换矩阵为$V^{-1}U$，从F到E的转换矩阵为$U^{-1}V$。<br>普通基之间的转换可以看成两步：先从普通基转换成标准基，再从标准基转换成普通基。</p>
<h3 id="行空间和列空间"><a href="#行空间和列空间" class="headerlink" title="行空间和列空间"></a>行空间和列空间</h3><p>矩阵的行向量张成的空间称为矩阵的行空间，同理对应到列空间。<br>两个行等价的矩阵有相同的行空间。令$A,B$为两行等价矩阵，B可由A经过若干次初等行变换获得，故B的所有行向量都可以表示成A的所有行向量的线性组合，因此B的所有行向量张成的向量空间 $$Span(b_1, \cdots, b_n) = c_1b_1 + \cdots + c_nb_n = d_1a_1+ \cdots + d_na_n = Span(a_1, \cdots, a_n)$$，即等于A的所有行向量张成的空间。</p>
<h3 id="秩（rank）"><a href="#秩（rank）" class="headerlink" title="秩（rank）"></a>秩（rank）</h3><p>A的行空间的维数称为矩阵A的秩。求解矩阵秩可以将其化成行阶梯型。<br>秩、零度（矩阵零空间的维度）、行阶梯型自由变量的个数及首变量个数满足：$A$化成行阶梯型$U$，$Ux=0$的首变量个数为$A$的行空间和列空间的秩，自由变量的个数等于零空间的维度。<br>首变量和自由变量的个数，取决于列向量是否线性相关：若列向量线性无关，则自由变量为0。</p>
<h3 id="线性方程组"><a href="#线性方程组" class="headerlink" title="线性方程组"></a>线性方程组</h3><p>线性方程组$Ax=b$相容的充要条件是b在A的列空间中。</p>
<blockquote>
<p>$Ax$可以是A的列向量以x为系数张成的空间  </p>
</blockquote>
<p>令A为$m \times n$矩阵，当且仅当A的列向量张成$R^m$时，对每一个$b \in R^m$，线性方程组$Ax=b$是相容的</p>
<blockquote>
<p>A的列向量张成$R^m$，等价于$n &gt;= m$</p>
</blockquote>
<p>当且仅当A的列向量线性无关时，对每一个$b \in R^m$，方程组$Ax=b$至多有一个解。</p>
<blockquote>
<p>方程组存在自由变量时，有多解。当A的列向量线性相关的时候，存在自由变量；线性无关时，不存在自由变量，方程至多有一个解。</p>
</blockquote>
<h2 id="线性变换"><a href="#线性变换" class="headerlink" title="线性变换"></a>线性变换</h2><hr>
<h3 id="线性变换的定义"><a href="#线性变换的定义" class="headerlink" title="线性变换的定义"></a>线性变换的定义</h3><p>一个将向量空间$V$映射到向量空间$W$的映射$L$，如果对所有的$v_1, v_2 \in V$以及所有的标量$\alpha$和$\beta$，满足以下条件，则其为线性变换：<br>$$ L(\alpha v_1+ \beta v_2) = \alpha L(v_1) + \beta L(v_2) $$</p>
<blockquote>
<p>以上条件等价于$L(v_1+v_2) = L(v_1) + L(v_2)$ 和 $L(\alpha v) = \alpha L(v)$</p>
</blockquote>
<p>若向量空间$V$和$W$相同，那么$L: V \rightarrow V$称为$V$上的线性算子。</p>
<h3 id="象与核"><a href="#象与核" class="headerlink" title="象与核"></a>象与核</h3><p>令$L: V \rightarrow W$为一线性变换，$L$的核记为$ker(L)$, $ker(L) = {v\in V | L(v)=0_w}$</p>
<blockquote>
<p>核对应为使得经过线性变换之后为零向量的V的子空间</p>
</blockquote>
<p>令S为V的一个子空间，S的象记为$L(S)$，即对所有的$v \in S$, $L(v)$构成的集合。</p>
<h3 id="线性变换的矩阵表示"><a href="#线性变换的矩阵表示" class="headerlink" title="线性变换的矩阵表示"></a>线性变换的矩阵表示</h3><p>令$L$为一从$R^n$到$R^m$的线性变换，则存在一个$m \times n$的矩阵A，使得对于每一个$x \in R^n$, 有$L(x) = Ax$.</p>
<blockquote>
</blockquote>
<p>$$<br>L(x) = L(x_1e_1 + \cdots + x_ne_n) = x_1L(e_1) + \cdots + x_nL(e_n)<br>\\ = (L(e_1), L(e_2), \cdots, L(e_n))<br>\begin{bmatrix} x_1 \\ x_2 \\ \vdots \\ x_n \\ \end{bmatrix}<br>$$</p>
<p>令$E=[u_1, u_2, \cdots, u_n], F=[b_1, \cdots, b_m]$分别为$R^n$和$R^m$的有序基，若$L: R^n \rightarrow R^m$为一线性变换，且A为L相应于E和F的表示矩阵，则<br>$$ a_j = B^{-1}L(u_j), j=1, \cdots, n$$</p>
<blockquote>
<p>从E到F的线性转换，对于E来说，不论E采用的是标准基($e_1, \cdots, e_n$)还是普通基，$L(v) = L(a_1u_1 + \cdots + a_nu_n) = a_1L(u_1) + \cdots + a_nL(u_n)$，经$A=(L(u_1), \cdots, L(u_n))$转换之后，$v$都转换成了F的向量空间中的向量，且是用标准基表示的。若F不是标准基，则需要进行一次坐标转换，从标准基坐标，转换成普通基坐标。此次基变换只是一次坐标变换，即向量的实际空间位置是不变的，变化的是其表示方式，即其在普通基中的坐标。</p>
</blockquote>
<h3 id="齐次坐标系"><a href="#齐次坐标系" class="headerlink" title="齐次坐标系"></a>齐次坐标系</h3><blockquote>
<p>前面我们看到，所有的线性变换都可以表示为三类的组合：缩放，旋转，关于某轴对称。但平移不是线性变换。为了让平移也能用线性变换类似的方式表示，引入了齐次坐标。</p>
</blockquote>
<p>$R^2$中的平移，需要调整两方面。首先是点的表示，<br>$$ \begin{bmatrix} x_1 \\ x_2 \end{bmatrix} \rightarrow \begin{bmatrix} x_1 \\ x_2 \\ 1 \end{bmatrix} $$<br>其次是转换矩阵A，若平移向量为$a = (6, 2)^T$，则转换矩阵为<br>$$ \begin{bmatrix} 1 &amp; 0 \\ 0 &amp; 1 \end{bmatrix} \rightarrow \begin{bmatrix} 1 &amp; 0 &amp;  6 \\ 0 &amp; 1 &amp; 2 \\ 0 &amp; 0 &amp; 1 \end{bmatrix} $$</p>
<blockquote>
<p>将单位矩阵的最后一行和最后一列添加到$2 \times 2$矩阵，然后将平移向量替换最后一列的前两个元素 </p>
</blockquote>
<h3 id="相似性"><a href="#相似性" class="headerlink" title="相似性"></a>相似性</h3><blockquote>
<p>线性变换的表示矩阵A会因基的选择而发生变化，若$A$和$B$都表示同一个线性变换对应于不同的基的线性转换，我们称$A$和$B$相似。</p>
</blockquote>
<p>令$E=[v_1, v_2, \cdots, v_n], F= [w_1, w_2, \cdots, w_n]$为向量空间$V$的两个有序基，$L$为$V$上的线性算子。令$S$为$F$到$E$的转移矩阵。若$A$为$L$相应于$E$的表示矩阵，$B$为$L$相应于$F$的表示矩阵，则$B=S^{-1}AS$.</p>
<blockquote>
<p>以上等式可以这样理解：B的线性变换矩阵等同于，首先将B转换所对应的坐标，转移到A转换所对应的坐标中，即乘以S。得到的是相对于E的坐标，此时用A矩阵进行线性转换，得到的是转换之后在A对应的坐标中的表示；最后再转移到B对应的坐标中的表示，即乘以$S^{-1}$</p>
</blockquote>
<blockquote>
<p>NOTE: 转移矩阵和转换矩阵<br>转移矩阵是基变换的表示矩阵，可以理解为将同一个向量从一个有序基坐标中，转移到另一个有序基坐标，坐标发生了变化，但向量本身没有发生改变；<br>转换矩阵是从一个向量转换到另外一个向量的表示矩阵，向量本身发生了变化。</p>
</blockquote>
<blockquote>
<p>相似性的意义在于同一个线性变换可以用不同的转换矩阵表示，如果能找到一个简单的转换矩阵，如对角矩阵，转换运算会十分方便。因此，采用不同的有序基可以简化转换矩阵，从而简化运算。</p>
</blockquote>
<h2 id="正交性"><a href="#正交性" class="headerlink" title="正交性"></a>正交性</h2><hr>
<h3 id="内积空间"><a href="#内积空间" class="headerlink" title="内积空间"></a>内积空间</h3><p>定义了内积的向量空间为内积空间。两个向量的内积（标量积）为一个实数，等于<br>$$ x^Ty = x_1y_1 + \cdots + x_ny_n $$</p>
<p>若$x^Ty=0$, 则向量 $x$ 和向量 $y$ 正交，记为$x \bot y$</p>
<h3 id="欧几里得长度"><a href="#欧几里得长度" class="headerlink" title="欧几里得长度"></a>欧几里得长度</h3><p>$$  \left\lVert x \right\rVert = (x^Tx)^{1/2} = \sqrt {x_1^2 + x_2^2 + x_3^2} $$<br>向量x和y的距离定义为数值$\left\lVert x-y \right\rVert$<br>非零向量$x, y$的夹角为$\theta$，则<br>$$x^Ty = \left\lVert x \right\rVert \left\lVert y \right\rVert \cos\theta $$</p>
<blockquote>
<p>可通过余弦定理证明</p>
</blockquote>
<p>对于向量x和y，其单位向量分别为<br>$$<br>u = \frac{x}{\left\lVert x \right\rVert} \\<br>v = \frac{y}{\left\lVert y \right\rVert}  \\<br>\cos\theta = \frac{x^Ty}{||x|| ||y||} = u^Tv<br>$$</p>
<h3 id="标量投影和向量投影"><a href="#标量投影和向量投影" class="headerlink" title="标量投影和向量投影"></a>标量投影和向量投影</h3><p>标量投影指的是向量x在向量y上投影的标量长度，等于x的欧几里得长度乘以$\cos\theta$<br>$$<br>a = \frac{x^Ty}{||y||}<br>$$<br>向量投影指的是向量x在向量y上的分量，是一个向量，其大小等于标量投影，其方向为y的单位向量<br>$$<br>p = au = a \frac{y}{||y||} = \frac{x^Ty}{y^Ty} y<br>$$</p>
<h3 id="法向量"><a href="#法向量" class="headerlink" title="法向量"></a>法向量</h3><p>若$N=(a, b, c)^T$为一非零向量，$P_0=(x_0, y_0, z_0)$为一定点，使得$P_0 P$和$N$正交的点$P$的集合构成一个过$P_0$的三维空间中的平面$\pi$。向量$N$和平面$\pi$相互垂直，向量$N$称为平面$\pi$的法向量。此时,向量$P_0P$和向量$N$的内积为0，因此有<br>$$<br>a(x-x_0) + b(y-y_0) + c(z-z_0) = 0<br>$$</p>
<blockquote>
<p>以上为垂直于N且经过$P_0$的面的平面方程。</p>
</blockquote>
<h3 id="平面方程，点到面的距离"><a href="#平面方程，点到面的距离" class="headerlink" title="平面方程，点到面的距离"></a>平面方程，点到面的距离</h3><ol>
<li>知道法向量和一个定点，直接利用向量内积等于0构造平面方程；</li>
<li>知道两个向量，求这两个向量形成的平面的方程：先求出两个向量的向量积，等于求出了法向量，然后求过原点垂直于该法向量的平面</li>
<li>知道三个点：三个点求出两个向量，然后按2的方式求平面方程</li>
<li>知道一个点和平面方程，求点到平面的距离：平面上一个点和已知点构成的向量，在法向量上的标量投影</li>
</ol>
<h3 id="正交子空间"><a href="#正交子空间" class="headerlink" title="正交子空间"></a>正交子空间</h3><p>设$X$和$Y$为$R^n$的子空间，若对每一$x \in X$和$y \in Y$都有$x^Ty=0$，则称子空间$X$和$Y$是正交的，记为$X \bot Y$</p>
<h3 id="正交补"><a href="#正交补" class="headerlink" title="正交补"></a>正交补</h3><p>令$Y$为$R^n$的子空间，$R^n$中所有与$Y$中的每一个向量都正交的向量集合记为$Y^{\bot}$，集合$Y^{\bot}$称为Y的正交补。<br>$$ Y^{\bot} = {x \in R^n \vert x^Ty=0, 对每一y \in Y} $$</p>
<blockquote>
<p>所有的向量都可以看做是从原点出发的，所以三维空间中的一维子空间的正交补就是过原点的平面，而不是平行于该平面的所有平面。</p>
</blockquote>
<h3 id="基本子空间"><a href="#基本子空间" class="headerlink" title="基本子空间"></a>基本子空间</h3><p>若A为一$m \times n$矩阵，则$N(A)=R(A^T)^{\bot}$，且$N(A^T) = R(A)^{\bot}$</p>
<blockquote>
<p>$R(A)$是A的值域，也是A的列空间，即由A的列向量张成的空间。$R(A^T)$是A的行向量张成的空间。</p>
</blockquote>
<h3 id="直和"><a href="#直和" class="headerlink" title="直和"></a>直和</h3><p>若$U$和$V$为向量空间$W$的子空间，若对于$W$中的任一向量，都可以唯一地表示为$v+u$，其中$u \in U, v \in V$，则称W为$U, V$的直和，记作：$W = U \oplus V$</p>
<blockquote>
<p>直和不能按期字面意思理解，不是说两个子空间构成原空间，而是原空间中的任一向量都可以写成子空间U中的一个向量和子空间V中的一个向量的线性组合。</p>
</blockquote>
<h3 id="正交子空间定理"><a href="#正交子空间定理" class="headerlink" title="正交子空间定理"></a>正交子空间定理</h3><p>若S为$R^n$中的一个子空间，则$\dim S + \dim S^{\bot} = n$；若${x_1, \cdots, x_r}$为S的一组基，${x_{r+1}, \cdots, x_n}$为$S^{\bot}$的一组基，则${x_1, \cdots, x_r, x_{r+1}, \cdots, x_n}$为$R^n$的一组基。</p>
<blockquote>
<p>构造矩阵$\begin{bmatrix} x_1 \\ \vdots \\ x_r \end{bmatrix}$</p>
</blockquote>
<p>若S为$R^n$中的一个子空间，则$R^n = S \oplus S^{\bot} ; (S^{\bot})^{\bot} = S$</p>
<blockquote>
<p>根据上面的定理，S的有序基和其正交补空间的有序基合起来构成$R^n$的有序基，故其中的任一向量可表示为合并后的有序基的线性组合，因此可以表示为S和S的正交补空间的直和。</p>
</blockquote>
<blockquote>
<p>S和S的正交补空间互为正交补。</p>
</blockquote>
<p>若A为一$m \times n$矩阵，且$b \in R^m$，若b在A的值域中，则存在向量$x \in R^n$，使得$Ax = b$，因为$R(A) = N(A^T)^{\bot}, b \in R(A)$，所以$b \bot N(A^T)$;<br>若b不在A的值域中，b与$N(A^T)$不正交。</p>
<h3 id="矩阵决定的映射"><a href="#矩阵决定的映射" class="headerlink" title="矩阵决定的映射"></a>矩阵决定的映射</h3><p>任一$m \times n$矩阵A可以看成是从$R^n \text{到} R^m$的线性变换。<br>$$<br>x \in R^n \rightarrow Ax \in R^m \\<br>\text{因为}R(A^T) = N(A)^{\bot} \\<br>x = y + z, y \in R(A^T), z \in N(A) \\<br>Ax = Ay + Az = Ay \\<br>\text{因此}R(A) = \lbrace Ax | x \in R^n \rbrace = \lbrace Ay | y \in R(A^T) \rbrace<br>$$</p>
<h3 id="最小二乘法"><a href="#最小二乘法" class="headerlink" title="最小二乘法"></a>最小二乘法</h3><p>给定一个$m \times n$的方程组$Ax = b, m &gt; n$，因为$m&gt;n$，所以矩阵A非满秩，A的列空间为$R^m$中的r维子空间（r是A的秩），若b不在A的列空间中，则方程没有解。但可以找到一个解x，使得$b-Ax$最小。<br>这里假定A的列空间是个三维空间中的二维子空间，即一个面，b刚好不在该空间中，令$p \in R(A)$，则$b - p$等于b的向量顶点到A的子空间平面的距离时，$b-Ax$最小。</p>
<blockquote>
<p>矩阵A的列空间是$R^m$中的子空间，所以很大概率b不在A的列空间中，因此没有一个准确的解满足超定方程组，使得$Ax=b$。取$Ay=p$，p在A的列空间中，使得$b-p$最小的y为该超定方程的最小二乘解。欲使其最小，需满足<br>$$b-p \in S^{\bot}, S=R(A), S^{\bot} = N(A^T) \\<br> b-p \in N(A^T), A^T(b-p) = 0, A^Tb = A^TAy$$</p>
</blockquote>
<blockquote>
<p>证明$b-p \in S^{\bot}, p=A\hat{x}$时，残差$r = b - Ax$有最小值<br>$$<br>令r(A) = b - y, y \in R(A)\\<br>因R(A)^{\bot} = N(A^T) \\<br>b = c + d, c \in R(A), d \in N(A^T) \\<br>r(A) = b - c + c - y = (b-c) + (c - y), \\<br>b-c=z \in N(A^T), c-y \in R(A) \\<br>||r(A)|| = \left\lVert (b-c) + (c-y) \right\rVert ^ 2 = \left\lVert (b-c)\right\rVert ^2 + \left\lVert (c-y) \right\rVert ^ 2 \\<br>|| b-y ||^2 = \left\lVert (b-c)\right\rVert ^2 + \left\lVert (c-y) \right\rVert ^ 2<br>$$<br>b, c为常量，y为变量，即当y刚好为b在R(A)中的投影时，$y=c$，残差有最小值，$b -c$。此时<br>$$ Ax = c, b = Ax + d, b-Ax = d \in N(A^T)$$</p>
</blockquote>
<h3 id="最小二乘解"><a href="#最小二乘解" class="headerlink" title="最小二乘解"></a>最小二乘解</h3><p>若A是一<strong>秩为n</strong>的$m \times n$矩阵，则正规方程组$A^TAx = A^Tb$有唯一解，解为:<br>$$\hat{x} = (A^TA)^{-1}A^Tb$$</p>
<blockquote>
<p>若矩阵A的秩不是n，则超定方程的最小二乘解有无穷多个。求解的方法跟正常情况一样，不过$A^TA$不是非奇异矩阵，故没有逆。</p>
</blockquote>
<h3 id="最优最小二乘拟合"><a href="#最优最小二乘拟合" class="headerlink" title="最优最小二乘拟合"></a>最优最小二乘拟合</h3><p>最优最小二乘拟合分两类：最优线性最小二乘拟合和最优n次多项式最小二乘拟合。对于最优线性最小二乘拟合，<br>$$<br>y = c_0 + c_1x \\<br>A = \begin{bmatrix} 1 &amp; x_1 \\<br>1 &amp; x_2 \\<br>\vdots \\<br>1 &amp; x_n \end{bmatrix} \\<br>c = (c_0, c_1)^T \\<br>Ac = (y_1, y_2, \cdots, y_n)^T<br>$$<br>对于最优n次多项式最小二乘拟合<br>$$<br>y = c_0 + c_1x + c_2x^2 + \cdots + c_nx^n \\<br>\begin{bmatrix} 1 &amp; x_1 &amp; x_1^2 &amp; \cdots &amp; x_1^n \\<br>\vdots \\<br>1 &amp; x_m &amp; x_m^2 &amp; \cdots &amp; x_m^n \\ \end{bmatrix}<br>\begin{bmatrix} c_0 \\ \vdots \\ c_n \end{bmatrix}<br>= \begin{bmatrix} y_1 \\ \vdots \\ y_m \end{bmatrix}<br>$$</p>
<h3 id="广义上的内积空间"><a href="#广义上的内积空间" class="headerlink" title="广义上的内积空间"></a>广义上的内积空间</h3><blockquote>
<p>以上我们接触到的内积又称为标量积，是定义在$R^n$空间中的；内积空间还可以定义在其他向量空间中，包括$R^{m \times n}, C[a, b], P_n$<br>函数向量空间有定义域，是区间；多项式向量空间的定义域为多个实数。</p>
</blockquote>
<h3 id="广义内积的定义"><a href="#广义内积的定义" class="headerlink" title="广义内积的定义"></a>广义内积的定义</h3><p>一个向量空间$V$上的内积为$V$上的运算，它将向量$x$和$y$与一个<strong>实数</strong>$\langle x, y \rangle$关联，并满足：</p>
<ol>
<li>$\langle x, x \rangle \geqslant 0$，等号成立的充要条件是$x = 0$</li>
<li>对$V$中的所有$x, y$，有$\langle x, y \rangle = \langle y, x \rangle$</li>
<li>对$V$中所有的$x, y, z$及所有标量$\alpha, \beta$，有$\langle \alpha x + \beta y, z \rangle = \alpha \langle x, z \rangle + \beta \langle y, z \rangle$</li>
</ol>
<blockquote>
<p>向量空间$V$中的内积运算可以自己定义，但必须满足以上条件</p>
</blockquote>
<h3 id="内积空间中向量的长度"><a href="#内积空间中向量的长度" class="headerlink" title="内积空间中向量的长度"></a>内积空间中向量的长度</h3><p>定义了内积的向量空间中的向量，其长度表示为$\left\lVert x \right\rVert = \sqrt {\langle x, x \rangle}$</p>
<h3 id="向量空间的范数"><a href="#向量空间的范数" class="headerlink" title="向量空间的范数"></a>向量空间的范数</h3><p>范数是一个与内积无关的定义，是将向量空间中每一个向量$v \in V$与一个实数相关联，该实数就是范数，该运算（属性）需要满足：</p>
<ol>
<li>$||v|| \geqslant 0$，其中等式成立的充要条件是$v = 0$；</li>
<li>对任一标量$\alpha, ||\alpha v|| = |\alpha|\left\lVert v \right\rVert$</li>
<li>对所有的$v, w \in V, ||v+w|| \leqslant ||v|| + ||w||$</li>
</ol>
<blockquote>
<p>$||x|| = \sqrt {\langle x, x \rangle}$定义了一个范数，称为2范数。范数有很多，常见的如一范数，p范数，无穷范数等等。<br>范数跟内积的区别：范数定义的是向量本身的一个属性；内积定义的是两个向量之间的运算，即使是两个向量相等时，描述的仍然是向量之间的运算。</p>
</blockquote>
<h3 id="正交集"><a href="#正交集" class="headerlink" title="正交集"></a>正交集</h3><p>令$\lbrace v_1, v_2, \cdots, v_n \rbrace$为一内积空间$V$中的非零向量，若当$i != j, \langle v_i, v_j \rangle = 0$，则${v_1, v_2, \cdots, v_n}$称为向量的正交集；<br>若${v_1, v_2, \cdots, v_n}$为单位向量，则该集合称为规范正交集，亦可称为内积空间V的子空间$Span(v_1, v_2, \cdots, v_n)$中的<strong>规范正交基</strong>；
正交集的向量线性无关。</p>
<blockquote>
<p>正交集要求各向量之间相互正交，但不要求正交集的向量张成原始向量空间，所以正交集不一定构成正交基</p>
</blockquote>
<h3 id="规范正交基的性质"><a href="#规范正交基的性质" class="headerlink" title="规范正交基的性质"></a>规范正交基的性质</h3><p>令$\lbrace u_1, u_2, \cdots, u_n \rbrace$为一个内积空间$V$的规范正交基，若$v = \sum_{i=1}^n c_iu_i$，则$c_i = \langle v, u_i \rangle$</p>
<blockquote>
<p>可以看做是将向量v用新的有序基表示出来，之前我们可以直接通过求逆的方式求出v在新的有序基中的坐标；现在规范正交基中，可以通过更简单的方式求出在各个有序基上的坐标</p>
</blockquote>
<blockquote>
<p>为什么可以通过内积的方式计算坐标呢？内积的定义没有固定的表示，向量空间可以随意定义内积，只要符合内积的条件。<br>原因在于，在确定了内积的定义之后，才有规范正交基（是否正交）</p>
</blockquote>
<p>若$u = \sum_{i=1}^n a_iu_i, v = \sum_{i=1}^n b_iu_i$，则$\langle u, v \rangle = \sum_{i=1}^n a_ib_i$</p>
<h3 id="帕塞瓦尔公式"><a href="#帕塞瓦尔公式" class="headerlink" title="帕塞瓦尔公式"></a>帕塞瓦尔公式</h3><p>若$\lbrace u_1, u_2, \cdots, u_n \rbrace$为一个内积空间$V$的一组规范正交基，且$ v = \sum_{i=1}^n c_iu_i$，则$ \left\lVert v \right\rVert ^2 = \sum_{i=1}^n c_i^2$</p>
<h3 id="正交矩阵"><a href="#正交矩阵" class="headerlink" title="正交矩阵"></a>正交矩阵</h3><p>若一个$n \times n$矩阵$Q$的列向量构成$R^n$中的一组规范正交基，则称$Q$为正交矩阵</p>
<blockquote>
<p>正交矩阵各列向量之间正交，每一个列向量都是单位向量；正交矩阵是方阵</p>
</blockquote>
<p>正交矩阵的性质：$Q^TQ=I, Q^{-1} = Q^T$</p>
<blockquote>
<p>注意$Q, Q^T$的顺序</p>
</blockquote>
<p>正交矩阵和内积：$\langle Qx, Qy \rangle = \langle x, y \rangle$</p>
<blockquote>
<p>$&lt;Qx, Qy&gt; = (Qy)^TQx = y^TQ^TQx = y^Tx = &lt;x, y&gt;$</p>
</blockquote>
<p>$\left\lVert Qx \right\rVert_2 = \left\lVert x \right\rVert_2$</p>
<blockquote>
<p>若将$Q$看做转换矩阵，上式表示用一个正交矩阵对向量进行线性转换之后，向量的长度保持不变</p>
</blockquote>
<h3 id="置换矩阵"><a href="#置换矩阵" class="headerlink" title="置换矩阵"></a>置换矩阵</h3><p>单位矩阵$I$的各列重新排列获得的矩阵称为置换矩阵。置换矩阵乘以目标矩阵，目标矩阵的各行将按照置换矩阵的各行排列顺序进行排列；目标矩阵乘以置换矩阵，目标矩阵各<strong>列</strong>将按照置换矩阵的各列的排列顺序进行排列。</p>
<blockquote>
<p>置换矩阵是正交矩阵，故$Q^{-1} = Q^T$</p>
</blockquote>
<h3 id="规范正交基和最小二乘法"><a href="#规范正交基和最小二乘法" class="headerlink" title="规范正交基和最小二乘法"></a>规范正交基和最小二乘法</h3><p>令$S$为一个内积空间$V$的子空间，并令$x \in V, \lbrace u_1, u_2, \cdots, u_n \rbrace$为$S$的一组规范正交基。若$p = \sum_{i=1}^n c_iu_i,\text{其中} c_i=\langle x, u_i \rangle$,则$p - x \in S^{\bot}$</p>
<p>$p$称为$x$到$S$上的投影；令$U = (u_1, u_2, \cdots, u_k)$，则$b$到$S$上的投影$p = UU^Tb$；其中，$UU^T$为$b$到$R^m$子空间$S$上的投影矩阵。</p>
<blockquote>
<p>证明：$$p = \sum_{i=1}^n \langle b, u_i \rangle u_i \\<br>= c_1u_1 + c_2u_2 + \cdots + c_nu_n = U(c_1, \cdots, c_n)^T \\<br>= U(u_1^Tb, u_2^Tb, \cdots, u_n^Tb)^T \\<br>= UU^Tb  $$</p>
</blockquote>
<p>要求$V$中任一向量$v$到其子空间$S$上的投影，只需构造$S$的规范正交基$U$，$ p = UU^Tv$</p>
<h3 id="函数逼近"><a href="#函数逼近" class="headerlink" title="函数逼近"></a>函数逼近</h3><p>利用一些特殊类型的函数集合对一个连续函数进行逼近。</p>
<blockquote>
<p>最优线性最小二乘逼近：在某个区间上定义内积运算，通过$\langle 1, x-a \rangle = 0$找出两个正交的向量，然后分别单位化，得到规范正交基$U$，然后用$U$表示目标函数在由$U$张成的子空间中的投影。此投影即为最小二乘逼近</p>
</blockquote>
<h3 id="三角多项式逼近"><a href="#三角多项式逼近" class="headerlink" title="三角多项式逼近"></a>三角多项式逼近</h3><p>用于逼近周期函数，其内积定义一般为在$[-\pi, \pi]$上，$&lt;f, g&gt; = \frac{1}{\pi}\int_{-\pi}^{\pi}f(x)g(x)dx$，在该内积空间内，$\frac{1}{\sqrt{2}}, \cos x, \sin x, \cos 2x, \sin 2x, \cdots, \cos nx, \sin nx$为一个规范正交集<br>三角多项式的形式为<br>$$<br>t_n(x) = \frac{a_0}{2} + \sum_{k=1}^n(a_k\cos kx + b_k\sin kx) \\<br>$$</p>
<blockquote>
<p>即将$f(x)$投影到规范正交集张成的函数向量空间中，以此最小二乘逼近原函数</p>
</blockquote>
<p>其中<br>$$<br>a_k = \langle f, \cos kx \rangle = \frac{1}{\pi}\int_{-\pi}^{\pi}f(x)\cos kx dx<br>\\<br>b_k = \langle f, \sin kx \rangle = \frac{1}{\pi}\int_{-\pi}^{\pi}f(x)\sin kx dx<br>$$<br>对于特殊情况$a_0$，<br>$$<br>a_0 = \langle f, \cos 0x \rangle = \langle f, 1 \rangle = \sqrt{2} \langle f, \frac{1}{\sqrt{2}} \rangle<br>\\<br> \frac{a_0}{2} = \langle f, \frac{1}{\sqrt{2}} \rangle \frac{1}{\sqrt{2}}<br>$$<br>注意到当$f(x)$确定了，$a_k， b_k$也便是常数，若令<br>$$<br>r_k = \sqrt{a_k^2 + b_k^2}, \theta_k = \tan^{-1}(\frac{b_k}{a_k})<br>$$<br>则
$$<br>a_k\cos kx + b_k\sin kx = r_k(\frac{a_k}{r_k}\cos kx + \frac{b_k}{r_k} \sin kx) \\<br>= r_k\cos (kx - \theta)<br>$$<br>因此$t_n(x)$可以看做是简谐运动的叠加。</p>
<h3 id="三角多项式逼近的复数形式"><a href="#三角多项式逼近的复数形式" class="headerlink" title="三角多项式逼近的复数形式"></a>三角多项式逼近的复数形式</h3><p>令
$$<br>c_k = \frac{1}{2}(a_k -ib_k) \\<br>= \frac{1}{2\pi}\int_{-\pi}^{\pi}f(x)(\cos kx - i\sin kx)dx \\<br>= \frac{1}{2\pi}\int_{-\pi}^{\pi}f(x)e^{-ikx}dx<br>$$<br>同时，令$c_k$的共轭$c_{-k}$为<br>$$<br>c_{-k} = \frac{1}{2}(a_k+ib_k) = \frac{1}{2\pi}\int_{-\pi}^{\pi}f(x)e^{ikx}dx<br>$$<br>因此<br>$$<br>a_k = c_k + c_{-k}, b_k = i(c_k - c_{-k}) \\<br>a_k\cos kx + b_k \sin kx = c_k\cos kx + c_{-k} \cos kx + ic_k \sin kx - ic_{-k}\sin kx \\<br>= c_k e^{ikx} + c_{-k}e^{-ikx}<br>$$</p>
<p>三角形式的复数形式表达式为<br>$$<br>t_n(x) = \sum_{k=-n}^{n}c_ke^{ikx}<br>$$</p>
<h3 id="傅里叶变换"><a href="#傅里叶变换" class="headerlink" title="傅里叶变换"></a>傅里叶变换</h3><h4 id="抑制高频的方法"><a href="#抑制高频的方法" class="headerlink" title="抑制高频的方法"></a>抑制高频的方法</h4><h4 id="离散傅里叶变换"><a href="#离散傅里叶变换" class="headerlink" title="离散傅里叶变换"></a>离散傅里叶变换</h4><h4 id="快速傅里叶变换"><a href="#快速傅里叶变换" class="headerlink" title="快速傅里叶变换"></a>快速傅里叶变换</h4><h2 id="特征值"><a href="#特征值" class="headerlink" title="特征值"></a>特征值</h2><hr>
<h3 id="特征向量和特征值"><a href="#特征向量和特征值" class="headerlink" title="特征向量和特征值"></a>特征向量和特征值</h3><h4 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h4><p>令$A$为一个$n \times n$矩阵，如果存在一个非零向量$x$使得$Ax = \lambda x$，则称标量$\lambda$为特征值，向量$x$为属于$\lambda$的特征向量。</p>
<blockquote>
<p>首先，特征值和特征向量是相对于方阵而言的，方阵对应的线性变换为线性算子，即在同一向量空间中的线性转换。特征向量的特殊之处在于，矩阵$A$乘以特征向量相当于对特征向量进行缩放，简化了矩阵乘法。所以，将向量转移成由特征向量为基的坐标表示的形式，再进行矩阵乘法，会简化运算。</p>
</blockquote>
<h4 id="求解方法"><a href="#求解方法" class="headerlink" title="求解方法"></a>求解方法</h4><p>$$<br>Ax = \lambda x \\<br>(A-\lambda I)x=0 \\<br>$$</p>
<p>即上式有非平凡解，等价于$A -\lambda I$为奇异的，特征多项式$p(\lambda)= det(A-\lambda I) = 0$，其中$N(A-\lambda I)$为对应于$\lambda$的特征空间（即由特征向量张成的特征空间）。</p>
<blockquote>
<p>特别注意：对某一矩阵，特征值是唯一的（可能有重根），但每个特征向量的取值不是唯一的，而是一个一维向量，即若$x_1$是某一特征值对应的特征向量，$\alpha x_1$也是对应的特征向量</p>
</blockquote>
<h4 id="性质"><a href="#性质" class="headerlink" title="性质"></a>性质</h4><p>如果考虑重根和复数的情况，$A$刚好有n个特征值；所有特征值的和等于$A$的对角线元素之和$$\lambda <em>1+ \lambda _2+ \cdots + \lambda _n = trace(A) = \sum</em>{i=1}^{n} a_{ii}$$<br>所有特征值的乘积等于$A$的行列式，$det(A) = \lambda _1\cdot  \lambda _2 \cdots \lambda _n$</p>
<h4 id="复特征值"><a href="#复特征值" class="headerlink" title="复特征值"></a>复特征值</h4><p>若矩阵为一实元素矩阵，</p>
<p>若$A$和$B$为有复元素的矩阵，且乘法$AB$可行，则$\overline{AB} = \overline{A} | \overline{B}$</p>
<h4 id="相似矩阵的特征值"><a href="#相似矩阵的特征值" class="headerlink" title="相似矩阵的特征值"></a>相似矩阵的特征值</h4><p>若矩阵$A, B$相似，$B = S^{-1}AS$，则这两个矩阵有相同的特征多项式，相应地它们有相同的特征值。但对应于各特征值的特征向量不一样。</p>
<h4 id="延申的性质"><a href="#延申的性质" class="headerlink" title="延申的性质"></a>延申的性质</h4><ol>
<li><p>三角形矩阵的特征值为矩阵的对角元素</p>
</li>
<li><p>$A$为奇异的充要条件是：$\lambda=0$为$A$的一个特征值</p>
</li>
<li><p>矩阵$A$和$A^T$具有相同的特征值（可以通过特征值之和和特征值的乘积进行证明），但对应的特征向量不一样</p>
</li>
<li><p>若矩阵$Q$为一正交矩阵，则其特征值$\lambda$满足$|\lambda | = 1$</p>
<blockquote>
<p>证明：<br>$$<br>Qx = \lambda x \\<br>(Qx)^T = \lambda x^T \\<br>(Qx)^TQx = x^Tx = \lambda x^T \lambda x = \lambda ^2 x^Tx \\<br>\lambda ^2 = 1<br>$$</p>
</blockquote>
</li>
</ol>
<h3 id="对角化"><a href="#对角化" class="headerlink" title="对角化"></a>对角化</h3><h4 id="特征向量"><a href="#特征向量" class="headerlink" title="特征向量"></a>特征向量</h4><p>若$\lambda_1, \lambda_2, \cdots, \lambda_k$为一个$n\times n$矩阵$A$的不同特征值，相应的特征向量为$x_1, \cdots, x_k$，则$x_1, \cdots, x_k$线性无关</p>
<h4 id="对角化-1"><a href="#对角化-1" class="headerlink" title="对角化"></a>对角化</h4><p>若存在一个非奇异矩阵$X$使得$A = XDX^{-1}$，其中D为对角矩阵，则称A可对角化。</p>
<p>$n\times n$矩阵A可对角化的充要条件是A有n个线性无关的特征向量。</p>
<blockquote>
<p>什么时候A有n个线性无关的特征向量呢？</p>
<ol>
<li>如果A有n个不相等的特征值，则对应的n个特征向量线性无关，满足条件；</li>
<li>如果A有k个不相等的特征值($k&lt;n$)，但仍然有n个线性无关的特征向量</li>
</ol>
</blockquote>
<blockquote>
<p>线性无关的特征向量小于n个的矩阵，称为退化的。</p>
</blockquote>
<blockquote>
<p>证明：如果A可对角化，即存在非奇异矩阵$X$满足$$ AX = XD \\ A(x_1, \cdots, x_n) = (Ax_1, \cdots, Ax_n) = (d_{11}x_1, \cdots, d_{nn}x_n) \\ Ax_1 = d_{11}x_1, \cdots, Ax_n = d_{nn}x_n$$</p>
<p>反之，如果A存在n个线性无关的特征向量，则令$X = (x_1, x_2, \cdots, x_n)$，则有$AX = XD$，其中D为对角矩阵，对角元素为特征值</p>
</blockquote>
<p>矩阵对角化，D为对角矩阵，对角元素为特征值，X为特征向量构成的矩阵。对角化矩阵X不是唯一的，将X的各列重新排列，或者各列都乘以一个不等或相等的非零的标量，就可以获得一个新的对角化矩阵$X$</p>
<blockquote>
<p>$X = (x_1, x_2, \cdots, x_n)$，其中特征向量的选取不受限制，可以进行任意缩放。</p>
</blockquote>
<p>证明$(c_1x_1, c_2x_2, \cdots, c_nx_n)$亦满足对角化<br>$$<br>A = XDX^{-1} \\<br>B = (c_1x_1, c_2x_2, \cdots, c_nx_n) \\<br>B = XC \\<br>BDB = XCD(XC)^{-1} = XCDC^{-1}X^{-1} \\<br>CDC^{-1} = D \\<br>BDB = A<br>$$</p>
<h4 id="几何重数和代数重数"><a href="#几何重数和代数重数" class="headerlink" title="几何重数和代数重数"></a>几何重数和代数重数</h4><p>几何重数和代数重数都是相对于矩阵A在某一特征值下而言的。<br>几何重数：特征值为$\lambda$时，对应的特征空间的维度；<br>代数重数：特征值的大小，即该特征值所对应的特征向量缩放的大小。</p>
<h4 id="随机矩阵"><a href="#随机矩阵" class="headerlink" title="随机矩阵"></a>随机矩阵</h4><p>马尔科夫链</p>
<h4 id="矩阵指数"><a href="#矩阵指数" class="headerlink" title="矩阵指数"></a>矩阵指数</h4><p>给定一个标量$\alpha$，指数可以表示为一个幂级数$e^{\alpha} = 1+\alpha + \frac{1}{2!}\alpha ^2 + \frac{1}{3!}\alpha ^3 + \cdots$</p>
<p>同理，对于任何$n\times n$矩阵A，可以定义矩阵指数为一个收敛的幂级数$e^A = I + A + \frac{1}{2!}A^2 + \frac{1}{3!}A^3+\cdots$</p>
<p>若A为对角矩阵, D的n次方等于将对角元素进行n次方运算，<br>$$<br>D = \lim (I+D+\frac{1}{2!}D^2 + \frac{1}{3!}D^3 + \cdots) \\<br>$$<br>故$e^D$为对角矩阵，对角元素为$(e^{d_1}, e^{d_2}, \cdots, e^{d_n})$。若A可对角化，<br>$$<br>A = XDX^{-1} \\<br>e^A = e^{XDX^{-1}} = I + XDX^{-1} + \frac{1}{2!}XD^2X^{-1} + \frac{1}{3!}XD3X^{-1} +\cdots \\<br> = X(I+D + \frac{1}{2!}D^2+ \cdots)X^{-1} = Xe^DX^{-1}<br>$$</p>
<h3 id="埃尔米特矩阵"><a href="#埃尔米特矩阵" class="headerlink" title="埃尔米特矩阵"></a>埃尔米特矩阵</h3><h4 id="复数的向量空间和标量域"><a href="#复数的向量空间和标量域" class="headerlink" title="复数的向量空间和标量域"></a>复数的向量空间和标量域</h4><p>$C^n$表示所有n元复数组构成的向量空间，$C$表示复数集合构成的标量域。</p>
<p>若$a = a+bi$为一复数标量，则$a$的长度为$|a| = \sqrt{\overline{a}a} = \sqrt{a^2+b^2}$</p>
<p>$C^n$中的向量$z = (z_1, \cdots, z_n)^T$的长度为$||z|| = \sqrt{z^Hz}$</p>
<p>令$M = (m_{ij})$为一$m \times n$矩阵，且对每一个$i, j, m_{ij} = a_{ij}+ ib_{ij}$，我们可以将$M$写成$M = A + iB$，其中$M$的共轭为$\overline{M} = A - iB$。$M$的转置记为$M^H$，等于将M的所有元素先求共轭，再矩阵转置。</p>
<p>复数矩阵满足</p>
<ol>
<li>$(A^H)^H = A$</li>
<li>$(\alpha A + \beta B)^H = \overline{\alpha}A^H + \overline{\beta}B^H$</li>
<li>$(AC)^H = C^HA^H$</li>
</ol>
<h4 id="复内积"><a href="#复内积" class="headerlink" title="复内积"></a>复内积</h4><table>
<thead>
<tr>
<th>$R^n$</th>
<th>$C^n$</th>
</tr>
</thead>
<tbody><tr>
<td>$&lt;x, y&gt; = y^Tx$</td>
<td>$&lt;z, w&gt; = w^Hz; &lt;z,w&gt; = \overline{&lt;w, z&gt;}$</td>
</tr>
<tr>
<td>$x^Ty = y^Tx$</td>
<td>$z^Hw = \overline{w^Hz}$</td>
</tr>
<tr>
<td>$\left\lVert x\right\rVert ^2 = x^Tx$</td>
<td>$\left\lVert z\right\rVert ^2 = z^Hz$</td>
</tr>
</tbody></table>
<h4 id="埃尔米特矩阵-1"><a href="#埃尔米特矩阵-1" class="headerlink" title="埃尔米特矩阵"></a>埃尔米特矩阵</h4><p>若一个矩阵M满足$M = M^H$，则称之为埃尔米特矩阵</p>
<blockquote>
<p>若M为实元矩阵，则$M^H = M^T$；若M为一实对称矩阵，M为埃尔米特矩阵</p>
<p>埃尔米特矩阵的对角元素一定是实的。</p>
</blockquote>
<p>埃尔米特矩阵的特征值都是实的，且属于不同特征值的特征向量是正交的。</p>
<blockquote>
<p>证明：令$a = x^HAx$，因为a为复标量，故$\overline{a} = a^H = x^HAx = a$，故标量$a$是实数。因为$a = x^HAx = x^H\lambda x = \lambda ||x||^2$，所以$\lambda = \frac{a}{||x||^2}$</p>
<p>$(Ax_1)^Hx_2 = x_1^HA^Hx_2 = x_1^HAx_2 = x_1^H\lambda _2 x_2=\lambda_2x_1^Hx_2$</p>
<p>$(Ax_1)^Hx_2 = (x_2^HAx_1)^H = (x_2^H\lambda_1 x_1)^H = \lambda_1x_1^Hx_2$</p>
<p>$(\lambda_1 - \lambda_2)x_1^Hx_2 = 0$</p>
</blockquote>
<blockquote>
<p>实对称矩阵对于不同特征值的特征向量是正交的。</p>
</blockquote>
<h4 id="酉矩阵"><a href="#酉矩阵" class="headerlink" title="酉矩阵"></a>酉矩阵</h4><p>若一个$n\times n$矩阵$U$的列向量构成了$C^n$中的一个规范正交集，则称之为酉矩阵。</p>
<blockquote>
<p>酉矩阵满足$U^HU = I, U^H = U ^{-1}$，实的酉矩阵就是正交矩阵。</p>
</blockquote>
<h4 id="舒尔定理"><a href="#舒尔定理" class="headerlink" title="舒尔定理"></a>舒尔定理</h4><p>对每一个$n \times n$矩阵A，存在一个酉矩阵$U$，使得$U^HAU$为上三角的。$A = UTU^H$通常称为A的舒尔分解。</p>
<p>证明：数学归纳法证明。</p>
<p>首先，对于n为1的情况，满足条件。假定对于$n=k$满足条件，当$n = k+1$时，即当A为$(k+1)\times (k+1)$的矩阵时，假设A存在一个</p>
<p>实舒尔定理：若A是一个实的$n\times n$矩阵，则存在一个正交矩阵$Q$，使得$Q^TAQ$为上三角的。</p>
<h4 id="谱定理"><a href="#谱定理" class="headerlink" title="谱定理"></a>谱定理</h4><p>若A为埃尔米特矩阵，则存在一个酉矩阵U对角化A。</p>
<p>若A为一实对称矩阵，则存在一个正交矩阵对角化A。</p>
<h4 id="最终定理"><a href="#最终定理" class="headerlink" title="最终定理"></a>最终定理</h4><p>对任意埃尔米特矩阵A，存在一个酉矩阵U对角化它。</p>
<blockquote>
<p>证明：根据舒尔定理，存在一个酉矩阵$U$上三角化A，$U^HAU = T$，其中T为上三角矩阵。$T^H = (U^HAU)^H = U^HA^HU = U^HAU = T$，T满足上三角矩阵，同时还是埃尔米特矩阵，故T为对角矩阵。</p>
</blockquote>
<ol>
<li>若埃尔米特矩阵$A$的特征值互不相同，则存在一个酉矩阵$U$对角化$A$。此时求解该酉矩阵只需对每个特征向量求单位向量，$(\frac{x_1}{||x_1||^2}, \cdots, \frac{x_n}{||x_n||}^2)$即为我们要求的酉矩阵U</li>
</ol>
<blockquote>
<p>若矩阵A的特征值互不相同，则其特征向量是正交的，对每一个特征向量求单位向量，即可构成酉矩阵。</p>
</blockquote>
<ol start="2">
<li>若埃尔米特矩阵$A$的特征值存在重根，亦存在一个酉矩阵$U$对角化A；矩阵$U$通过求出重根对应的特征空间的规范正交基，再跟其他特征向量组合成酉矩阵U。</li>
</ol>
<blockquote>
<p>为何可以对重根的特征向量通过格拉姆-施密特方法构造规范正交基，但不能对非重根的特征向量也采用该方法构造规范正交基？<br>因为重根的特征空间是二维的，普通特征值的特征空间是一维的。A在特征空间内的作用是scaling，所以对重根特征值对应的特征空间，A乘以该特征空间内的任意一向量，作用都是scaling，因此在该特征空间内，求出一个规范正交基，可以替代原始的不正交的两个（或多个）特征向量。</p>
</blockquote>
<h4 id="正规矩阵"><a href="#正规矩阵" class="headerlink" title="正规矩阵"></a>正规矩阵</h4><p>满足$A^HA = AA^H$的矩阵A称为正规矩阵。A为正规矩阵的充要条件是A有一个完备的规范正交的特征向量集。</p>
<blockquote>
<p>若A有一个完备的规范正交的特征向量集，则A可对角化为$A = UDU^H$，因为D为对角矩阵，故$DD^H = D^HD$<br>$$<br>A^HA = UD^HU^HUDU^H =UD^HDU^H \\<br>AA^H = UDU^HUD^HU^H = UDD^HU^H \\<br>AA^H = A^HA<br>$$</p>
</blockquote>
<blockquote>
<p>若$A^HA = AA^H$。首先，对于矩阵A，存在一个酉矩阵U和一个上三角矩阵，使得$A = UTU^H$，$$ T = U^HAU \\ T^HT = U^HA^HUU^HAU = U^HA^HAU \\<br>TT^H = U^HAUU^HA^HU = U^HAA^HU \\<br>T^HT = TT^H $$<br>因为T为上三角矩阵，且$TT^H$和$T^HT$相等，比较二者的对角元素可以发现，对于T矩阵，当$i\ne j, t_{ij} = 0$，即表明T为对角矩阵。因此，T不仅是上三角矩阵，而且是对角矩阵，故U对角化了A，且U的列向量为A的特征向量。从而表明，A有一个完备的规范正交的特征向量集。</p>
</blockquote>
<p>埃尔米特矩阵一定是正规矩阵，因为埃尔米特矩阵有完备的规范正交的特征向量集。</p>
<h4 id="练习注意项"><a href="#练习注意项" class="headerlink" title="练习注意项"></a>练习注意项</h4><ol>
<li>令w为一复标量，则$\overline{w} = w^H$</li>
<li>令w为一复标量，$u$为一复向量，则$wu^H = u^Hw^H = \overline{w}u^H$</li>
</ol>
<h3 id="奇异值分解"><a href="#奇异值分解" class="headerlink" title="奇异值分解"></a>奇异值分解</h3><h4 id="定义-1"><a href="#定义-1" class="headerlink" title="定义"></a>定义</h4><p>将矩阵$A$ 因式分解成$U\Sigma V^T$称为奇异值分解，其中$U$为$m\times m$的正交矩阵，V为$n\times n$的正交矩阵，$\Sigma$是$m\times n$的矩阵，其形式如下：<br>$$<br>\Sigma = \begin{bmatrix} \Sigma_1 &amp; 0 \\ 0 &amp; 0 \end{bmatrix} \\<br>$$<br>其中$\Sigma_1$是对角矩阵，其对角元素为矩阵$A^TA$的非零特征值按从大到小排序之后，开方，即$\sigma _i = \sqrt{\lambda_i}$</p>
<blockquote>
<p>若A的秩为$\gamma$，则矩阵$A^TA$的秩也为$\gamma$？证明之</p>
</blockquote>
<h4 id="求解方法-1"><a href="#求解方法-1" class="headerlink" title="求解方法"></a>求解方法</h4><p>首先，计算矩阵$A^TA$的特征值，进而求出奇异值，构造$\Sigma$（按照奇异值从大到小的顺序排列）；</p>
<p>然后对应于每一个特征值，求解$A^TA$的特征向量，构造$V = (v_1, v_2, \cdots, v_n)$；</p>
<p>对于矩阵$U$，其前n个列向量（若$m \gt n$）可以根据公式$u_i = \frac{1}{\sigma_i}Av_i$求解。</p>
<h3 id="正定矩阵"><a href="#正定矩阵" class="headerlink" title="正定矩阵"></a>正定矩阵</h3><h4 id="定义-2"><a href="#定义-2" class="headerlink" title="定义"></a>定义</h4><p>若对$R^n$中所有非零向量$x$，实对称矩阵A满足$x^TAx \gt 0$，则称矩阵$A$是正定的。</p>
<p>对称矩阵A满足正定矩阵的充要条件是矩阵A的所有特征值均为正的。</p>
<blockquote>
<p>证明：首先，令$\lambda_1$为矩阵A的特征值，对应的特征向量为$x_1$，则有$Ax_1 = \lambda x_1$。又因为对于所有非零向量都满足$x^TAx \gt 0$， 所以$x_1^TAx_1 = x_1^T\lambda_1 x_1 = \lambda_1 ||x_1||^2 \gt 0$，因此有$\lambda_1 \gt 0$；反之，若对称矩阵所有的特征值都大于0，令特征向量$x_1, \cdots, x_n$构成$R^n$中的一组规范正交基，则任意向量可表示为$x = c_1x_1 + \cdots + c_nx_n, x^TAx = x^T(\lambda_1c_1x_1 + \cdots + \lambda_nc_nx_n)$，故有$x^TAx = \lambda_1c_1^2 + \cdots + \lambda_nc_n^2$，因为特征值都大于0，故$x^TAx$也大于0</p>
</blockquote>
<h4 id="性质-1"><a href="#性质-1" class="headerlink" title="性质"></a>性质</h4><ol>
<li><p>正定矩阵A为非奇异的；</p>
</li>
<li><p>正定矩阵A的行列式大于0，$det(A) &gt; 0$；</p>
</li>
<li><p>正定矩阵的前主子矩阵（前主子矩阵为去掉矩阵A的最后n-r行和列得到的矩阵）$A_1, A-2, \cdots, A_n$均为正定的；</p>
<blockquote>
<p>证明：前主子矩阵$A_r$，令$x_r = (x_1, x_2, \cdots, x_r), x = (x_1, \dots, x_r, 0, 0, \cdots)$，其中$x_1, \cdots, x_r$为$R^n$中任意非零向量。若能证明$x_r^TA_rx_r &gt; 0$，则可证明$A_r$为正定的。因为$x_r^TA_rx_R = x^TAx \gt 0$，故$A_r$为正定的。</p>
</blockquote>
</li>
<li><p>正定矩阵A可以仅使用行运算三（加上另外一行的n倍）化为上三角矩阵，且主元将全为正的。</p>
<blockquote>
<p>首先，因为前主子矩阵$A_1$为正定矩阵，所以其为非奇异的，$det(A_1) \gt 0$，所以$a_{11}$大于0，因此可以利用$a_{11}$上三角化$A_2$，上三角化之后，因为只使用了初等行运算3，所以$A_2$的行列式不变，$a_{11}\times a_{22}$等于原$A_2$的行列式，因为原$A_2$的行列式大于0，所以$a_{11}a_{22} \gt 0$，故而$a_{22} \gt 0$。因为$a_{11}, a_{22}$都大于0，故可以利用$a_{11},a_{22}$上三角化$A_3$，同上可以证明上三角化之后的$a_{33}$大于0。以此类推，可证正定矩阵可仅用初等行运算3化为上三角矩阵，且主元全为正的。</p>
</blockquote>
</li>
</ol>
<blockquote>
<p>能仅通过初等行运算三上三角化的矩阵，都能进行LU分解。</p>
<ol start="5">
<li>正定矩阵可分解为一个乘积：$LDL^T$。其中，$L$是下三角矩阵，对角线上元素为1；D为一个对角矩阵，其对角线上元素均为正的。<br>A可以进行LU分解，又因为$U$为上三角矩阵，对角线元素都为正的，所以U可以分解为$DU_1$，其中D为对角矩阵，$U_1$为上三角矩阵，对角元素全为1。因此有$A = LDU_1$，考虑到A为对称矩阵，所以$A = A^T, LDU_1 = U_1^TDL^T$，因为分解是唯一的，所以$U_1 = L^T$。</li>
</ol>
</blockquote>
<ol start="6">
<li>正定矩阵可以通过LU分解，进一步分解为$A = BB^T$的形式，其中$B = LD_1$，$D_1$是对角矩阵，对角元素为对角矩阵D的对角元素的开方。该分解称为楚列斯基分解。</li>
<li>若B为非奇异矩阵，则任何乘积$B^TB$都是正定矩阵。</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/24/Triple-Angular-ge2e-Loss/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="LegendGH">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LegendGH">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/24/Triple-Angular-ge2e-Loss/" itemprop="url">Triple, Angular, ge2e Loss</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-07-24T14:14:35+08:00">
                2019-07-24
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Triple-loss"><a href="#Triple-loss" class="headerlink" title="Triple loss"></a>Triple loss</h2><h3 id="mini-batch-selection"><a href="#mini-batch-selection" class="headerlink" title="mini batch selection"></a>mini batch selection</h3><p>Select <em>M</em> people, each people several items (there is no need to be equal for all people). For example, each batch select 10 person, each person got 20 face images / voice segments.</p>
<h3 id="generate-triplet"><a href="#generate-triplet" class="headerlink" title="generate triplet"></a>generate triplet</h3><p>Every items will be paired with items from the same people to generate positive pairs. For each positive pair, calculate the distances between the anchor item and items from different owner <code>negative_distances</code>. By subtructing <code>positive_distances</code> (positive pair distance) from <code>negative_distances</code>, we can have all negative pairs that meet our requirement: <code>negative_distance</code> - <code>positive_distance</code> is less than <code>alpha</code>, which means the negative item are too close to anchor item compared with positive item. Then from these negative pairs, select one randomly to generate triplet. Till now, we got a list of triplets: [<code>anchor item</code>, <code>positive item</code>, <code>negative item</code> ]</p>
<h3 id="calcuate-loss"><a href="#calcuate-loss" class="headerlink" title="calcuate loss"></a>calcuate loss</h3><p>Cossin similarity or Squared distance could be used to calculate the loss.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">select_triplets</span><span class="params">(embeddings, nrof_images_per_class, image_paths, people_per_batch, alpha)</span>:</span></span><br><span class="line">    <span class="string">""" Select the triplets for training</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    trip_idx = <span class="number">0</span></span><br><span class="line">    emb_start_idx = <span class="number">0</span></span><br><span class="line">    num_trips = <span class="number">0</span></span><br><span class="line">    triplets = []</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># VGG Face: Choosing good triplets is crucial and should strike a balance between</span></span><br><span class="line">    <span class="comment">#  selecting informative (i.e. challenging) examples and swamping training with examples that</span></span><br><span class="line">    <span class="comment">#  are too hard. This is achieved by extending each pair (a, p) to a triplet (a, p, n) by sampling</span></span><br><span class="line">    <span class="comment">#  the image n at random, but only between the ones that violate the triplet loss margin. The</span></span><br><span class="line">    <span class="comment">#  latter is a form of hard-negative mining, but it is not as aggressive (and much cheaper) than</span></span><br><span class="line">    <span class="comment">#  choosing the maximally violating example, as often done in structured output learning.</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(people_per_batch):  <span class="comment"># iterate over each person</span></span><br><span class="line">        nrof_images = int(nrof_images_per_class[i]) <span class="comment"># How many images each person got</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> xrange(<span class="number">1</span>,nrof_images): <span class="comment"># iterate over all images belonging to the current person</span></span><br><span class="line">            a_idx = emb_start_idx + j - <span class="number">1</span></span><br><span class="line">            neg_dists_sqr = np.sum(np.square(embeddings[a_idx] - embeddings), <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">for</span> pair <span class="keyword">in</span> xrange(j, nrof_images): <span class="comment"># For every possible positive pair.</span></span><br><span class="line">                p_idx = emb_start_idx + pair</span><br><span class="line">                pos_dist_sqr = np.sum(np.square(embeddings[a_idx]-embeddings[p_idx]))</span><br><span class="line">                <span class="comment"># exclude positive pairs</span></span><br><span class="line">                neg_dists_sqr[emb_start_idx:emb_start_idx+nrof_images] = np.NaN </span><br><span class="line">            </span><br><span class="line">                all_neg = np.where(neg_dists_sqr-pos_dist_sqr&lt;alpha)[<span class="number">0</span>] <span class="comment"># VGG Face selecction</span></span><br><span class="line">                nrof_random_negs = all_neg.shape[<span class="number">0</span>]</span><br><span class="line">                <span class="keyword">if</span> nrof_random_negs&gt;<span class="number">0</span>:</span><br><span class="line">                    rnd_idx = np.random.randint(nrof_random_negs)   <span class="comment"># after getting lots of candidates, choose one randomly</span></span><br><span class="line">                    n_idx = all_neg[rnd_idx]</span><br><span class="line">                    triplets.append((image_paths[a_idx], image_paths[p_idx], image_paths[n_idx]))</span><br><span class="line">                    <span class="comment">#print('Triplet %d: (%d, %d, %d), pos_dist=%2.6f, neg_dist=%2.6f (%d, %d, %d, %d, %d)' % </span></span><br><span class="line">                    trip_idx += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">                num_trips += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        emb_start_idx += nrof_images</span><br><span class="line"></span><br><span class="line">    np.random.shuffle(triplets)</span><br><span class="line">    <span class="keyword">return</span> triplets, num_trips, len(triplets)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">loss</span><span class="params">(y_pred)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    y_pred: [batch_size, embedding_size], it's composed of three parts: </span></span><br><span class="line"><span class="string">            first is the anchors' embeddings, second is the positives' embeddings,</span></span><br><span class="line"><span class="string">            the last is the negative embeddings.</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line"></span><br><span class="line">    elements = int(K.int_shape(y_pred)[<span class="number">0</span>] / <span class="number">3</span>)</span><br><span class="line">    anchor = y_pred[<span class="number">0</span>:elements]</span><br><span class="line"></span><br><span class="line">    positive_ex = y_pred[elements:<span class="number">2</span> * elements]</span><br><span class="line"></span><br><span class="line">    negative_ex = y_pred[<span class="number">2</span>*elements:]</span><br><span class="line"></span><br><span class="line">    sap = batch_cosin_similarity(anchor, positive_ex)</span><br><span class="line">    san = batch_cosin_similarity(anchor, negative_ex)</span><br><span class="line">    loss = K.maximum(san-sap+alpha, <span class="number">0.0</span>)</span><br><span class="line">    total_loss = K.sum(loss)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> total_loss</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/21/tensorflow-estimator/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="LegendGH">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LegendGH">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/21/tensorflow-estimator/" itemprop="url">tensorflow estimator</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-07-21T15:29:27+08:00">
                2019-07-21
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Estimator"><a href="#Estimator" class="headerlink" title="Estimator"></a>Estimator</h2><p>A high-level API that simplify training, evaluation, prediction and export for serving. Base class:  <code>tf.estimator.Estimator</code>. It provides the following benefits:</p>
<ol>
<li>Scalable (run in local host or distributed env) without modification of the source code;</li>
<li>Built on <code>tf.keras.layers</code>, which simplifies customization;</li>
<li>Many tasks handled automatically by Estimator, such as <code>Session</code> &amp; <code>Graph</code>.</li>
</ol>
<h2 id="Workflow-of-tensorflow-esitmator"><a href="#Workflow-of-tensorflow-esitmator" class="headerlink" title="Workflow of tensorflow esitmator"></a>Workflow of tensorflow esitmator</h2><p>There are mainly three components for tensorflow estimator: model_fn, input_fn and estimator.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">model_fn</span><span class="params">(features, labels, mode)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    This function does all the network computation</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    # `features`: input features</span></span><br><span class="line"><span class="string">    # `labels`: labels for responding example</span></span><br><span class="line"><span class="string">    # `mode`: training, evaluation or prediction</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    # Return: `tf.estimator.EstimatorSpec`</span></span><br><span class="line"><span class="string">    """</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># `tf.estimator.input.numpy_input_fn</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">numpy_input_fn</span><span class="params">(x, y=None, </span></span></span><br><span class="line"><span class="function"><span class="params">                batch_size=<span class="number">128</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">                num_epochs=<span class="number">1</span>, </span></span></span><br><span class="line"><span class="function"><span class="params">                shuffle=None, </span></span></span><br><span class="line"><span class="function"><span class="params">                queue_capacity=<span class="number">100</span>, </span></span></span><br><span class="line"><span class="function"><span class="params">                num_threads=<span class="number">1</span>)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Return: (features, labels). Features is a dict.</span></span><br><span class="line"><span class="string">    """</span></span><br></pre></td></tr></table></figure>

<p>The work flow</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># model_fn: </span></span><br><span class="line">image_classifier = tf.estimator.Estimator(model_fn=model_fn, model_dir=model_dir)</span><br><span class="line"></span><br><span class="line">train_input_fn = tf.esitmator.inputs.numpy_input_fn(x=train_data,</span><br><span class="line">                                                    y=train_labels,</span><br><span class="line">                                                    batch_size=<span class="number">64</span>,</span><br><span class="line">                                                    num_epochs=<span class="number">1</span>,</span><br><span class="line">                                                    shuffle=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> range(NUM_EPOCHS):</span><br><span class="line">    image_classifier.train(input_fn=train_input_fn)</span><br></pre></td></tr></table></figure>

<h2 id="Estimator-1"><a href="#Estimator-1" class="headerlink" title="Estimator"></a>Estimator</h2><p><code>Estimator</code>, <code>model_fn</code>, <code>input_fn</code>是三个主要成分。<br><code>Estimator</code>相当于一个controller，控制在三种不同的情况下(train, predict, evaluation)的工作流。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">tf.estimator.Estimator(</span><br><span class="line">    model_fn, </span><br><span class="line">    model_dir=<span class="literal">None</span>, </span><br><span class="line">    config=<span class="literal">None</span>, </span><br><span class="line">    params=<span class="literal">None</span>, </span><br><span class="line">    warm_start_from=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>model_fn: 见下方</li>
<li>model_dir： checkpoint路径，如果是已经存在的，则模型会load并restore from the checkpoint.</li>
<li>config: <code>tf.estimator.RunConfig</code></li>
<li>params: hyperparameters, type of dict. 如batch_size</li>
<li>warm_start_from: </li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">model_fn</span><span class="params">(features, labels, mode, paramas=None, config=None)</span></span></span><br></pre></td></tr></table></figure>

<ul>
<li>Features, labels是input_fn的返回值</li>
<li>mode是<code>train</code>, <code>eval</code> or <code>predict</code></li>
<li>params: 可以没有该参数；如果有的话，是<code>Estimator</code>中的该参数，用于配置hyperparameters</li>
<li>config：可以没有该参数；如果有的话，是<code>Estimator</code>中的config参数，Instance of <code>tf.estimator.RunConfig</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">tf.estimator.RunConfig(</span><br><span class="line">    model_dir=<span class="literal">None</span>, </span><br><span class="line">    tf_random_seed=<span class="literal">None</span>, </span><br><span class="line">    save_summary_steps=<span class="number">100</span>, </span><br><span class="line">    save_checkpoints_steps=&lt;object object at <span class="number">0x7efe9a76ca80</span>&gt;, </span><br><span class="line">    save_checkpoints_secs=&lt;object object at <span class="number">0x7efe9a76ca80</span>&gt;, </span><br><span class="line">    session_config=<span class="literal">None</span>, </span><br><span class="line">    keep_checkpoint_max=<span class="number">5</span>, </span><br><span class="line">    keep_checkpoint_every_n_hours=<span class="number">10000</span>, </span><br><span class="line">    log_step_count_steps=<span class="number">100</span>, </span><br><span class="line">    train_distribute=<span class="literal">None</span>, </span><br><span class="line">    device_fn=<span class="literal">None</span>, </span><br><span class="line">    protocol=<span class="literal">None</span>, </span><br><span class="line">    eval_distribute=<span class="literal">None</span>, </span><br><span class="line">    experimental_distribute=<span class="literal">None</span>, </span><br><span class="line">    experimental_max_worker_delay_secs=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>

<p>跟分布式训练相关的参数都是通过环境变量<code>os.environ[&#39;TF_CONFIG&#39;]</code>来设置的。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/16/Flask-with-uwsgi/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="LegendGH">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LegendGH">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/16/Flask-with-uwsgi/" itemprop="url">Flask with uwsgi</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-07-16T14:49:20+08:00">
                2019-07-16
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Should-we-use-uwsgi-with-Flask"><a href="#Should-we-use-uwsgi-with-Flask" class="headerlink" title="Should we use uwsgi with Flask?"></a>Should we use uwsgi with Flask?</h2><p>Every time when we run a flask app using the internal server, we are prompted to not use that server in production. I believe the warning is based on performance, but what’s the actually differences between using the build-in server and wsgi such as uwsgi? Let’s have a look.</p>
<p>First, let’s talk about multiple requests handling. Before I write this blog, I thought with the build-in server of flask, it can only handle one request per time. However, when I tested it with Locust, it can handle multiple request very well. The tested API is only a sleep function. So by default, the build in server enable threads to support multiple requests. </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># by default, this will enable multi-threads support</span></span><br><span class="line">app.run(host=<span class="string">'0.0.0.0'</span>, debug=<span class="literal">False</span>, port=<span class="number">80</span>)</span><br><span class="line"><span class="comment"># to disable it</span></span><br><span class="line">app.run(host=<span class="string">'0.0.0.0'</span>, debug=<span class="literal">False</span>, port=<span class="number">80</span>, threaded=<span class="literal">False</span>)</span><br><span class="line"><span class="comment"># note: when debug is True, any modification of the app will make the app get reloaded.</span></span><br></pre></td></tr></table></figure>

<p>So if our API is something like <code>sleep</code> fuction, only using the build-in server can satisfy us. However, in reality, most API will both have cpu-consuming tasks and io-waiting tasks.<br>Thus in theory, assigning multiple requests to one flask app (with multiple threads) can not take advantage of multiple cores due to python’s global GIL (global interprete lock).</p>
<h2 id="The-advantage-of-using-uwsgi"><a href="#The-advantage-of-using-uwsgi" class="headerlink" title="The advantage of using uwsgi"></a>The advantage of using uwsgi</h2><blockquote>
<ol>
<li>It can scale your APP automatically. </li>
</ol>
</blockquote>
<p>With uwsgi, you can set the minimum and maximum number of works to handle requests. When too many requests come in simultaneously, uwsgi would spawn extra processes to process these requests.</p>
<blockquote>
<ol start="2">
<li>With Uwsgi, you can take advantages of multiple cores.</li>
</ol>
</blockquote>
<p>If your app is computation heavy tasks (cpu intensive tasks) and you do not enable threads supporting in uwsgi configuration, each request will be processing in seperate process. </p>
<h2 id="Using-uwsgi-compared-with-multi-APP-instances"><a href="#Using-uwsgi-compared-with-multi-APP-instances" class="headerlink" title="Using uwsgi compared with multi APP instances"></a>Using uwsgi compared with multi APP instances</h2><p>By saying Multi app instances, I mean running multiple APP in different IP/Ports and using Nginx for load balancer. Running Multiple Apps has several constraints:</p>
<ol>
<li>You have to decide how many instances to run. It cannot scale automatically.</li>
<li>With <code>threaded support</code>, you are risking of handling multple requests in the same processes. This will compromise the performance. Without <code>threaded support</code>, you may have a longer response time since the next request won’t be processing until the current one finished. The largest number of requests you can handle simultaneously won’t be greater than the number of app instances.</li>
</ol>
<h2 id="Experiment"><a href="#Experiment" class="headerlink" title="Experiment"></a>Experiment</h2><p>The best way to verify a theory is by testing. </p>
<h3 id="Test-with-IO-heavy-task-threads-enabled"><a href="#Test-with-IO-heavy-task-threads-enabled" class="headerlink" title="Test with IO heavy task (threads enabled)"></a>Test with IO heavy task (threads enabled)</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hello</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment"># sleep for two seconds</span></span><br><span class="line">    time.sleep(<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"Hello world from flask"</span></span><br></pre></td></tr></table></figure>

<p>Then use <code>Locust</code> for testing. User number is 20, waiting time is 0.</p>
<p><img src="/images/flask_with_uwsgi/multi_flask_in_different_ports.png" alt="upstream" title="running multiple app and load balancing them with nginx "><br><img src="/images/flask_with_uwsgi/uwsgi_with_threads_supported.png" alt="upstream" title="uwsgi with threads enabled"></p>
<h3 id="Test-with-CPU-intensive-task-threads-enabled"><a href="#Test-with-CPU-intensive-task-threads-enabled" class="headerlink" title="Test with CPU intensive task (threads enabled)"></a>Test with CPU intensive task (threads enabled)</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hello</span><span class="params">()</span>:</span></span><br><span class="line">    np.random.random((<span class="number">40000</span>, <span class="number">3000</span>))</span><br><span class="line">    time.sleep(<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"create a shape of (40000, 3000) numpy array"</span></span><br></pre></td></tr></table></figure>

<p>NOTE: the average time cost for this function is <code>11000 ms</code> in this specific settings.</p>
<p>Then use <code>Locust</code> for test. User number is 10, waiting time is 0.</p>
<p><img src="/images/flask_with_uwsgi/multi_flask_in_3_ports_with_threads_enabled.png" alt="upstream" title="running three instance with threads enabled"></p>
<p><img src="/images/flask_with_uwsgi/uwsgi_threads_disabled_cpu_intensive_task.png" alt="upstream" title="uwsgi with threads disabled"></p>
<h2 id="Additional-settings"><a href="#Additional-settings" class="headerlink" title="Additional settings"></a>Additional settings</h2><h3 id="nginx-load-balancing"><a href="#nginx-load-balancing" class="headerlink" title="nginx load balancing"></a>nginx load balancing</h3><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">upstream</span> backend&#123;</span><br><span class="line">    <span class="attribute">server</span> <span class="number">0.0.0.0:81</span>;</span><br><span class="line">    <span class="attribute">server</span> <span class="number">0.0.0.0:82</span>;</span><br><span class="line">    <span class="attribute">server</span> <span class="number">0.0.0.0:83</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">80</span>;</span><br><span class="line">    <span class="attribute">location</span> / &#123;</span><br><span class="line">        <span class="attribute">proxy_pass</span> http://backend;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="uwsgi-configuration"><a href="#uwsgi-configuration" class="headerlink" title="uwsgi configuration"></a>uwsgi configuration</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[uwsgi]</span><br><span class="line">module = main</span><br><span class="line">callable = app</span><br><span class="line"># the minimum number of workers to keep all the time</span><br><span class="line">cheaper = 2</span><br><span class="line"># the maximum number of workers to spawn</span><br><span class="line">workers = 20</span><br><span class="line"># enable threads and set the threads as 5</span><br><span class="line">threads = 5</span><br><span class="line"></span><br><span class="line">socket = /tmp/uwsgi.sock</span><br><span class="line">chown-socket = nginx:nginx</span><br><span class="line">chmod-socket = 664</span><br><span class="line">hook-master-start = unix_signal:15 gracefuulay_kill_them_all</span><br></pre></td></tr></table></figure>


          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/05/PCA-VS-LDA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="LegendGH">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LegendGH">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/05/PCA-VS-LDA/" itemprop="url">PCA VS. LDA</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-07-05T14:34:48+08:00">
                2019-07-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="What’s-PCA"><a href="#What’s-PCA" class="headerlink" title="What’s PCA?"></a>What’s PCA?</h2><p>Principal Component Analysis is to maximize variance of dataset. It’s based on the idea that some features may be more important/diversified than others. </p>
<ol>
<li>PCA is a unsupervised algorithm, while LDA is supervised.</li>
</ol>
<h2 id="How-to-use-them"><a href="#How-to-use-them" class="headerlink" title="How to use them?"></a>How to use them?</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.decomposition <span class="keyword">import</span> PCA</span><br><span class="line">pca = PCA(n_components=<span class="number">2</span>)</span><br><span class="line">feature_reduced = pca.fit(X).transform(X)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.decomposition <span class="keyword">import</span> LDA</span><br><span class="line">lda = LDA(n_components=<span class="number">2</span>)</span><br><span class="line">feature_reduced = lda.fit(X).transform(X)</span><br></pre></td></tr></table></figure>

<p><a href="https://sebastianraschka.com/faq/docs/lda-vs-pca.html" target="_blank" rel="noopener">reference</a><br><a href="http://www.vfirst.com/blog/techfirst/dimension-reduction-techniques-pca-vs-lda-in-machine-learning-part-2/" target="_blank" rel="noopener">reference2</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/06/26/bert/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="LegendGH">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LegendGH">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/26/bert/" itemprop="url">bert</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-06-26T15:22:21+08:00">
                2019-06-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="What-is-bert"><a href="#What-is-bert" class="headerlink" title="What is bert?"></a>What is <code>bert</code>?</h2><p><img src="/images/bert/figure1.png" alt></p>
<h2 id="Bert-training"><a href="#Bert-training" class="headerlink" title="Bert training"></a>Bert training</h2><p>The rough process of training Bert is like: randomly mask some words in a sentence, then</p>
<h2 id="Data-preparation"><a href="#Data-preparation" class="headerlink" title="Data preparation"></a>Data preparation</h2><h3 id="Step-1"><a href="#Step-1" class="headerlink" title="Step 1"></a>Step 1</h3><p>Collect Corpus and arrange them by rules: one sentence per line and Each document are separated by a blank line.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Bidirectional Encoder Representations from Transformers (BERT) has shown marvelous improvements across various NLP tasks. </span><br><span class="line">Recently, an upgraded version of BERT has been released with Whole Word Masking (WWM), which mitigate the drawbacks of masking partial WordPiece tokens in pre-training BERT. </span><br><span class="line">In this technical report, we adapt whole word masking in Chinese text, that masking the whole word instead of masking Chinese characters, which could bring another challenge in Masked Language Model (MLM) pre-training task. </span><br><span class="line">The model was trained on the latest Chinese Wikipedia dump. </span><br><span class="line"></span><br><span class="line">We aim to provide easy extensibility and better performance for Chinese BERT without changing any neural architecture or even hyper-parameters. </span><br><span class="line">The model is verified on various NLP tasks, across sentence-level to document-level, including sentiment classification (ChnSentiCorp, Sina Weibo), named entity recognition (People Daily, MSRA-NER), natural language inference (XNLI), sentence pair matching (LCQMC, BQ Corpus), and machine reading comprehension (CMRC 2018, DRCD, CAIL RC). </span><br><span class="line">Experimental results on these datasets show that the whole word masking could bring another significant gain. Moreover, we also examine the effectiveness of Chinese pre-trained models: BERT, ERNIE, BERT-wwm.</span><br></pre></td></tr></table></figure>

<h2 id="Source-Code-Anatomy"><a href="#Source-Code-Anatomy" class="headerlink" title="Source Code Anatomy"></a>Source Code Anatomy</h2><h3 id="TrainingInstance"><a href="#TrainingInstance" class="headerlink" title="TrainingInstance"></a><code>TrainingInstance</code></h3><p><code>tokens</code>: tokens (words) after being masked<br><code>segment_ids</code>: [0,0,0,0,1,1,1]<br><code>is_random_next</code>: If the second segment is the next sentence of the first one<br><code>masked_lm_positions</code>: [5, 10, 34, 63], masked tokens’ index<br><code>masked_lm_labels</code>: [‘we’, ‘some’, ‘body’, ‘good’], the acctual token befor being replaced.</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/06/18/Binary-Search-Tree/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="LegendGH">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LegendGH">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/18/Binary-Search-Tree/" itemprop="url">Binary Search Tree</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-06-18T15:15:23+08:00">
                2019-06-18
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Algorithm/" itemprop="url" rel="index">
                    <span itemprop="name">Algorithm</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Algorithm/Tree/" itemprop="url" rel="index">
                    <span itemprop="name">Tree</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="pre"><a href="#pre" class="headerlink" title="pre"></a>pre</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TreeNode</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, val, left=None, right=None)</span>:</span></span><br><span class="line">        self.val = val</span><br><span class="line">        self.left = left</span><br><span class="line">        self.right = right</span><br></pre></td></tr></table></figure>

<h2 id="level-first-order-breadth-first-order-print-tree"><a href="#level-first-order-breadth-first-order-print-tree" class="headerlink" title="level first order/breadth first order print tree"></a>level first order/breadth first order print tree</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">print_tree</span><span class="params">(root)</span>:</span></span><br><span class="line">    <span class="comment"># use a FIFO queue to store trees to be printed</span></span><br><span class="line">    stack = []</span><br><span class="line">    <span class="keyword">if</span> root <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        print(<span class="literal">None</span>, end=<span class="string">'\t'</span>)</span><br><span class="line">        <span class="keyword">return</span> </span><br><span class="line">    <span class="keyword">while</span> stack <span class="keyword">or</span> root:</span><br><span class="line">        <span class="keyword">if</span> root <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            print(<span class="string">'null'</span>, end=<span class="string">'\t'</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># Print the value the current tree and put its children to queue</span></span><br><span class="line">            print(root.val, end=<span class="string">'\t'</span>)</span><br><span class="line">            stack.append(root.left)</span><br><span class="line">            stack.append(root.right)</span><br><span class="line">        <span class="comment"># Each time get a TreeNode from the front of the queue </span></span><br><span class="line">        root = stack.pop(<span class="number">0</span>)</span><br><span class="line">    print(<span class="string">'\n'</span>)</span><br></pre></td></tr></table></figure>

<h2 id="inorder-traversal-of-BST"><a href="#inorder-traversal-of-BST" class="headerlink" title="inorder traversal of BST"></a>inorder traversal of BST</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">traverse</span><span class="params">(root: TreeNode)</span>:</span></span><br><span class="line">    <span class="string">""" using stack """</span></span><br><span class="line"></span><br><span class="line">    final = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> stack <span class="keyword">or</span> root:</span><br><span class="line">        <span class="keyword">while</span> root:</span><br><span class="line">            stack.append((root.val, root.right))</span><br><span class="line">            root = root.left</span><br><span class="line"></span><br><span class="line">        val, right = stack.pop()</span><br><span class="line">        final.append(val)</span><br><span class="line">        root = right</span><br><span class="line">    <span class="keyword">return</span> final</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">another_inorder_traverse</span><span class="params">(root: TreeNode)</span>:</span></span><br><span class="line">    <span class="string">"""In-Place method, Morris traversal</span></span><br><span class="line"><span class="string">    Notice this method can not format a new flatten TreeNode in inorder-traversal.</span></span><br><span class="line"><span class="string">    Although it can produce values in inorder-traversal.</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    cur = root</span><br><span class="line">    final = []</span><br><span class="line">    <span class="keyword">while</span> cur:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> cur.left:</span><br><span class="line">            final.add(cur.val)</span><br><span class="line">            cur = cur.right</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            pre = cur.left</span><br><span class="line">            <span class="keyword">while</span> pre.right:</span><br><span class="line">                pre = pre.right</span><br><span class="line">            pre.right = cur</span><br><span class="line">            temp = cur</span><br><span class="line">            cur = cur.left</span><br><span class="line">            temp.left = <span class="literal">None</span></span><br><span class="line">    <span class="keyword">return</span> final</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">inorder_recursive</span><span class="params">(root: TreeNode)</span>:</span></span><br><span class="line">    <span class="string">"""Recursive method"""</span></span><br><span class="line">    <span class="keyword">if</span> root <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">return</span> []</span><br><span class="line">    <span class="keyword">return</span> inorder_recursive(root.left) + [root.val] + inorder_recursive(root.right)</span><br></pre></td></tr></table></figure>

<h2 id="preorder-traversal-of-BST"><a href="#preorder-traversal-of-BST" class="headerlink" title="preorder traversal of BST"></a>preorder traversal of BST</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">preorder</span><span class="params">(root: TreeNode)</span>:</span></span><br><span class="line">    <span class="string">"""Morris"""</span></span><br><span class="line">    <span class="keyword">if</span> root <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    cur = root</span><br><span class="line">    <span class="keyword">while</span> cur:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> cur.left:</span><br><span class="line">            cur = cur.right</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            pre = cur.left</span><br><span class="line">            <span class="keyword">while</span> pre <span class="keyword">and</span> pre.right:</span><br><span class="line">                pre = pre.right</span><br><span class="line">            pre.right = cur.right</span><br><span class="line">            tmp = cur</span><br><span class="line">            cur = cur.left</span><br><span class="line">            tmp.right = cur</span><br><span class="line">            tmp.left = <span class="literal">None</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">preorder_stack</span><span class="params">(root: TreeNode)</span>:</span></span><br><span class="line">    <span class="string">"""With stack"""</span></span><br><span class="line">    <span class="keyword">if</span> root <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    stack = []</span><br><span class="line">    <span class="keyword">while</span> stack <span class="keyword">or</span> root:</span><br><span class="line">        <span class="keyword">while</span> root <span class="keyword">and</span> root.left:</span><br><span class="line">            tmp = root</span><br><span class="line">            root = root.left</span><br><span class="line">            <span class="keyword">if</span> tmp.right:</span><br><span class="line">                stack.append(tmp.right)</span><br><span class="line">            tmp.right = root</span><br><span class="line">            tmp.left = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> root.right:</span><br><span class="line">            stack.append(root.right)</span><br><span class="line">            root.right = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> stack:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            right = stack.pop()</span><br><span class="line">            root.right = right</span><br><span class="line">            root = root.right</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">pre = <span class="literal">None</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">preorder_recursive</span><span class="params">(root: TreeNode)</span>:</span></span><br><span class="line">    <span class="string">"""Smart recursive"""</span></span><br><span class="line">    <span class="keyword">if</span> root <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    preorder_recursive(root.right)</span><br><span class="line">    preorder_recursive(root.left)</span><br><span class="line">    root.right = pre</span><br><span class="line">    root.left = <span class="literal">None</span></span><br><span class="line">    pre = root</span><br></pre></td></tr></table></figure>

<h2 id="postorder-traversal"><a href="#postorder-traversal" class="headerlink" title="postorder traversal"></a>postorder traversal</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">postorder_traversal</span><span class="params">(root: TreeNode)</span> -&gt; [int]:</span></span><br><span class="line">    <span class="string">"""with stack"""</span></span><br><span class="line">    <span class="keyword">if</span> root <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">return</span> []</span><br><span class="line">    stack = [(root, <span class="literal">False</span>)]</span><br><span class="line">    final = []</span><br><span class="line">    <span class="keyword">while</span> stack:</span><br><span class="line">        node, visited = stack.pop()</span><br><span class="line">        <span class="keyword">if</span> node:</span><br><span class="line">            <span class="keyword">if</span> visited:</span><br><span class="line">                final.append(node.val)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                stack.append((node, <span class="literal">True</span>))</span><br><span class="line">                stack.append((node.right, <span class="literal">False</span>))</span><br><span class="line">                stack.append((node.left, <span class="literal">False</span>))</span><br><span class="line">    <span class="keyword">return</span> final</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">reverse_pre</span><span class="params">(root: TreeNode)</span> -&gt; [int]:</span></span><br><span class="line">    <span class="string">"""Modified preorder traversal, then reverse the result"""</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">        <span class="keyword">return</span> []</span><br><span class="line">    stack = []</span><br><span class="line">    final = []</span><br><span class="line">    cur = root</span><br><span class="line">    <span class="keyword">while</span> stack <span class="keyword">or</span> cur:</span><br><span class="line">        <span class="keyword">while</span> cur:</span><br><span class="line">            final.append(cur.val)</span><br><span class="line">            stack.append(cur)</span><br><span class="line">            cur = cur.right</span><br><span class="line">        cur = stack.pop().left</span><br><span class="line">    final.reverse()</span><br><span class="line">    <span class="keyword">return</span> final</span><br></pre></td></tr></table></figure>

<h2 id="Traversal-Summary"><a href="#Traversal-Summary" class="headerlink" title="Traversal Summary"></a>Traversal Summary</h2><blockquote>
<p>Only preorder traversal can happen in place, namely forming a new <code>LinkedList</code> without using extra space. ???</p>
</blockquote>
<h2 id="unique-BST"><a href="#unique-BST" class="headerlink" title="unique BST"></a>unique BST</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen_tree</span><span class="params">(start, end)</span> -&gt; [TreeNode]:</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> start == end:</span><br><span class="line">        <span class="keyword">return</span> [TreeNode(start)]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> start &gt; end:</span><br><span class="line">        <span class="keyword">return</span> [<span class="literal">None</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    final = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(end-start+<span class="number">1</span>):</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">for</span> left <span class="keyword">in</span> gen_tree(start, start+i<span class="number">-1</span>):</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> right <span class="keyword">in</span> gen_tree(start+i+<span class="number">1</span>, end):</span><br><span class="line">                this = TreeNode(start+i)</span><br><span class="line">                this.left = left</span><br><span class="line">                this.right = right</span><br><span class="line">                final.append(this)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> final</span><br></pre></td></tr></table></figure>

<h2 id="permutation"><a href="#permutation" class="headerlink" title="permutation"></a>permutation</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">permutation</span><span class="params">(n)</span>:</span></span><br><span class="line"></span><br><span class="line">    res = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(n+<span class="number">1</span>)]</span><br><span class="line">    res[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, n+<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(i):</span><br><span class="line">            remain = i<span class="number">-1</span>-j</span><br><span class="line">            res[i] += res[j] * res[remain]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> res[n]</span><br></pre></td></tr></table></figure>


          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/06/17/hello-world/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="LegendGH">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LegendGH">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/17/hello-world/" itemprop="url">Hello World</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-06-17T15:39:17+08:00">
                2019-06-17
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/DL/" itemprop="url" rel="index">
                    <span itemprop="name">DL</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/DL/LSTM/" itemprop="url" rel="index">
                    <span itemprop="name">LSTM</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_cossim_my</span><span class="params">(embeddings)</span>:</span></span><br><span class="line">    b, n, v = embeddings.shape</span><br><span class="line">    left = embeddings.repeat(<span class="number">1</span>, <span class="number">1</span>, embeddings.size(<span class="number">0</span>)).view(b, n, b, v)</span><br><span class="line">    centroids = embeddings.mean(dim=<span class="number">1</span>)</span><br><span class="line">    right = centroids.repeat(b, n, <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">    s = embeddings.sum(dim=<span class="number">-2</span>, keepdim=<span class="literal">True</span>) - embeddings</span><br><span class="line">    s = s / (embeddings.shape[<span class="number">1</span>] - <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> b_idx <span class="keyword">in</span> range(b):</span><br><span class="line">        <span class="keyword">for</span> utt_idx <span class="keyword">in</span> range(n):</span><br><span class="line">            right[b_idx][utt_idx][b_idx] = s[b_idx][utt_idx]</span><br><span class="line">    sim = F.cosine_similarity(left, right, dim=<span class="number">-1</span>)</span><br><span class="line">    <span class="keyword">return</span> sim</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">LegendGH</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">8</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">4</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">LegendGH</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  


  

  

</body>
</html>
